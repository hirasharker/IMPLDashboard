@{
    ViewBag.Title = "IMPL Dashboard";
    var dt = DateTime.Now.AddDays(-1);
}

@section css{
    <style>
        #field_strudcture_wise_sales table {
            width: 100%;
            border-collapse: collapse;
        }

            #field_strudcture_wise_sales table th, td {
                border: 1px solid #ccc;
                padding: 6px;
            }

        #field_strudcture_wise_sales .group-header {
            background-color: #dfeeff;
            font-weight: bold;
        }

        #field_strudcture_wise_sales .subgroup-header {
            background-color: #f1faff;
        }

        #field_strudcture_wise_sales .toggle-icon {
            display: inline-block;
            width: 1em;
            margin-right: 5px;
            font-weight: bold;
        }

        #field_strudcture_wise_sales .hidden {
            display: none;
        }

        #field_strudcture_wise_sales table tr td a {
            /* text-decoration: none;*/
            color: #007bff;
        }
    </style>
}

<div class="page-content">
    <div class="container-fluid">

        <div class="row">
            <div class="col">

                <div class="h-100">
                    <div class="row mb-3 pb-1">
                        <div class="col-12">
                            <div class="d-flex align-items-lg-center flex-lg-row flex-column">
                                <div class="flex-grow-1">
                                    @*<h4 class="fs-16 mb-1">Welcome, Hira!</h4>
                                        <p class="text-muted mb-0">
                                            Here's what's happening with Ifad Multi Products Ltd.
                                        </p>*@
                                </div>
                                <div class="mt-3 mt-lg-0">
                                    <form action="javascript:void(0);">
                                        <div class="row g-3 mb-0 align-items-center">
                                            <div class="col-sm-auto">
                                                <div class="input-group">
                                                    <input type="date"
                                                           class="form-control border-0 dash-filter-picker shadow" value="@dt.ToString("yyyy-MM-dd")" id="dashboard-header-date" />
                                                </div>
                                            </div>
                                            <!--end col-->
                                        </div>
                                        <!--end row-->
                                    </form>
                                </div>
                            </div><!-- end card header -->
                        </div>
                        <!--end col-->
                    </div>
                    <!--end row-->

                    <div class="row" id="dashboard-header">



                    </div>

                    <div class="row">
                        <div class="col-xl-12">
                            <div class="card">
                                <div class="card-header align-items-center d-flex">
                                    <h4 class="card-title mb-0 flex-grow-1">National Focus SKU KPI Update</h4>
                                    <div class="flex-shrink-0" style="margin-right: 2em">
                                        <div class="input-group">
                                            <select id="national-sku-kpi-region" class="form-control border-0 shadow">
                                                <option value="">Select Region</option>
                                                @{
                                                    foreach (System.Data.DataRow row in ViewBag.region.Rows)
                                                    {
                                                        <option value="@row["REGION_ID"]">@row["REGION_NAME"]</option>
                                                    }
                                                }
                                            </select>
                                        </div>
                                    </div>

                                    <div class="flex-shrink-0" style="margin-right: 2em">
                                        <div class="input-group">
                                            <select id="national-sku-kpi-area" class="form-control border-0 shadow">
                                                <option value="">Select Area</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="flex-shrink-0">
                                        <div class="input-group">
                                            <input type="date" id="nation-wise-sku-kpi-date"
                                                   class="form-control border-0 dash-filter-picker shadow" value="@dt.ToString("yyyy-MM-dd")" />
                                        </div>
                                    </div>
                                </div><!-- end card header -->

                                <div class="card-body position-relative" style="min-height: 300px;">
                                    <div class="table-responsive table-card" id="nation-wise-sku-kpi">
                                        <!-- Data loads here -->
                                    </div>
                                </div>

                            </div> <!-- .card-->
                        </div> <!-- .col-->
                    </div> <!-- end row-->

                    <div class="row">
                        <div class="col-xl-12">
                            <div class="card">
                                <div class="card-header align-items-center d-flex">
                                    <h4 class="card-title mb-0 flex-grow-1">Own DB Focus SKU KPI Update</h4>

                                    <div class="flex-shrink-0" style="margin-right: 2em">
                                        <div class="input-group">
                                            <select id="own-db-sku-kpi-region" class="form-control border-0 shadow">
                                                <option value="">Select Region</option>
                                                @{
                                                    foreach (System.Data.DataRow row in ViewBag.region.Rows)
                                                    {
                                                        <option value="@row["REGION_ID"]">@row["REGION_NAME"]</option>
                                                    }
                                                }
                                            </select>
                                        </div>
                                    </div>

                                    <div class="flex-shrink-0" style="margin-right: 2em">
                                        <div class="input-group">
                                            <select id="own-db-sku-kpi-area" class="form-control border-0 shadow">
                                                <option value="">Select Area</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="flex-shrink-0">
                                        <div class="input-group">
                                            <input type="date" id="owndb-wise-sku-kpi-date"
                                                   class="form-control border-0 dash-filter-picker shadow" value="@dt.ToString("yyyy-MM-dd")" />
                                        </div>
                                    </div>


                                </div><!-- end card header -->

                                <div class="card-body position-relative" style="min-height: 300px;">
                                    <div class="table-responsive table-card" id="owndb-wise-sku-kpi">
                                        <!-- Data loads here -->
                                    </div>
                                </div>

                            </div> <!-- .card-->
                        </div> <!-- .col-->
                    </div> <!-- end row-->

                    <div class="row">
                        <div class="col-xl-12">
                            <div class="card">
                                <div class="card-header align-items-center d-flex">
                                    <h4 class="card-title mb-0 flex-grow-1">MTD Secondaray Sales Vs Primary Sales in Crore</h4>
                                    <div class="flex-shrink-0" style="margin-right: 2em">
                                        <div class="input-group">
                                            <select id="nation-wise-mtd-pri-vs-sec-channel" class="form-control border-0 shadow">
                                                <option value="">National</option>
                                                <option value="GT">GT</option>
                                                <option value="MT">MT</option>
                                            </select>
                                        </div>
                                    </div>


                                    <div class="flex-shrink-0">
                                        <div class="input-group">
                                            <input type="date" id="nation-wise-sec-vs-primary-dt"
                                                   class="form-control border-0 dash-filter-picker shadow" value="@dt.ToString("yyyy-MM-dd")" />
                                        </div>
                                    </div>
                                </div><!-- end card header -->

                                <div class="card-body position-relative" style="min-height: 300px;">
                                    <div class="table-responsive table-card" id="nation-wise-mtd-pri-vs-sec-sales">
                                        <!-- Data loads here -->
                                    </div>
                                </div>

                            </div> <!-- .card-->
                        </div> <!-- .col-->
                    </div> <!-- end row-->

                    <div class="row">
                        <div class="col-xl-8">
                            <div class="card">
                                <div class="card-header border-0 align-items-center d-flex">
                                    <h4 class="card-title mb-0 flex-grow-1">MoM Business Progress</h4>
                                    <div class="flex-shrink-0" style="margin-right: 2em">
                                        <div class="input-group">
                                            <input type="month" id="mom-business-progress-date"
                                                   class="form-control border-0 dash-filter-picker shadow" value="@dt.ToString("yyyy-MM")" />
                                        </div>
                                    </div>
                                    <div class="flex-shrink-0" style="margin-right: 2em">
                                        <div class="flex-shrink-0" style="margin-right: 2em">
                                            <div class="input-group">
                                                <select class="form-control border-0 shadow" id="mom-business-channel">
                                                    <option value="">National</option>
                                                    <option value="GT">GT</option>
                                                    <option value="MT">Modern Trade</option>
                                                    <option value="INSTITUTION">Institution</option>

                                                </select>
                                            </div>
                                        </div>
                                    </div>

                                    @*<div class="flex-shrink-0" style="margin-right: 2em">
                                            <div class="flex-shrink-0" style="margin-right: 2em">
                                                <div class="input-group">
                                                    <select class="form-control border-0 shadow" id="mom-no-months">
                                                        <option value="12">12</option>
                                                        <option value="18">18</option>
                                                        <option value="24">24</option>

                                                    </select>
                                                </div>
                                            </div>
                                        </div>*@


                                </div><!-- end card header -->



                                <div class="card-body p-0 pb-2">
                                    @*<div class="w-100">
                                            <div id="customer_impression_charts"
                                                 data-colors='["--vz-light", "--vz-primary", "--vz-secondary"]'
                                                 class="apex-charts" dir="ltr"></div>
                                        </div>*@
                                    <div class="w-100">
                                        <div id="mom_business_progress" style="height:400px"
                                             data-colors='["--vz-primary","--vz-light",  "--vz-secondary"]'
                                             class="apex-charts" dir="ltr"></div>
                                    </div>



                                </div><!-- end card body -->
                            </div><!-- end card -->
                        </div><!-- end col -->

                        <div class="col-xl-4">
                            <!-- card -->
                            <div class="card card-height-100">
                                <div class="card-header align-items-center d-flex">
                                    <h4 class="card-title mb-0 flex-grow-1">Sales by Locations</h4>
                                    <div class="flex-shrink-0">
                                        <button type="button" class="btn btn-soft-primary btn-sm">
                                            Export Report
                                        </button>
                                    </div>
                                </div><!-- end card header -->
                                <!-- card body -->
                                <div class="card-body">

                                    @*<div id="sales-by-locations"
                                        data-colors='["--vz-light", "--vz-success", "--vz-primary"]'
                                        style="height: 269px" dir="ltr"></div>*@

                                    <div class="px-2 py-2 mt-1">
                                        <p class="mb-1">Canada <span class="float-end">75%</span></p>
                                        <div class="progress mt-2" style="height: 6px;">
                                            <div class="progress-bar progress-bar-striped bg-primary"
                                                 role="progressbar" style="width: 75%" aria-valuenow="75"
                                                 aria-valuemin="0" aria-valuemax="75"></div>
                                        </div>

                                        <p class="mt-3 mb-1">
                                            Greenland <span class="float-end">47%</span>
                                        </p>
                                        <div class="progress mt-2" style="height: 6px;">
                                            <div class="progress-bar progress-bar-striped bg-primary"
                                                 role="progressbar" style="width: 47%" aria-valuenow="47"
                                                 aria-valuemin="0" aria-valuemax="47"></div>
                                        </div>

                                        <p class="mt-3 mb-1">Russia <span class="float-end">82%</span></p>
                                        <div class="progress mt-2" style="height: 6px;">
                                            <div class="progress-bar progress-bar-striped bg-primary"
                                                 role="progressbar" style="width: 82%" aria-valuenow="82"
                                                 aria-valuemin="0" aria-valuemax="82"></div>
                                        </div>
                                    </div>
                                </div>
                                <!-- end card body -->
                            </div>
                            <!-- end card -->
                        </div>
                        <!-- end col -->
                    </div>




                    <div class="row">


                        <!-- end col -->
                        <div class="col-xl-12">
                            <div class="card">
                                <div class="card-header border-0 align-items-center d-flex">
                                    <h4 class="card-title mb-0 flex-grow-1">MoM Focus Category Business Progress</h4>
                                    <div class="flex-shrink-0" style="margin-right: 2em">
                                        <div class="input-group">
                                            <input type="month" id="mom-focus-cat-business-progress-date"
                                                   class="form-control border-0 dash-filter-picker shadow" value="@dt.ToString("yyyy-MM")" />
                                        </div>
                                    </div>
                                    <div class="flex-shrink-0" style="margin-right: 2em">
                                        <div class="flex-shrink-0" style="margin-right: 2em">
                                            <div class="input-group">
                                                <select class="form-control border-0 shadow" id="mom-focus-cat-business-channel">
                                                    <option value="">National</option>
                                                    <option value="GT">GT</option>
                                                    <option value="MT">Modern Trade</option>
                                                    <option value="INSTITUTION">Institution</option>

                                                </select>
                                            </div>
                                        </div>
                                    </div>




                                </div><!-- end card header -->



                                <div class="card-body p-0 pb-2">


                                    <div class="w-100">
                                        <div id="mom_focus_cat_business_progress" style="height:400"
                                             data-colors='["--vz-primary","--vz-light",  "--vz-secondary"]'
                                             class="apex-charts" dir="ltr"></div>
                                    </div>



                                </div><!-- end card body -->
                            </div><!-- end card -->



                            <div class="card">
                                <div class="card-header border-0 align-items-center d-flex">
                                    <h4 class="card-title mb-0 flex-grow-1">MoM Focus Category Business Progress</h4>
                                    <div class="flex-shrink-0" style="margin-right: 2em">
                                        <div class="input-group">
                                            <input type="month" id="mom-eco-memo-business-progress-date"
                                                   class="form-control border-0 dash-filter-picker shadow" value="@dt.ToString("yyyy-MM")" />
                                        </div>
                                    </div>
                                    <div class="flex-shrink-0" style="margin-right: 2em">
                                        <div class="flex-shrink-0" style="margin-right: 2em">
                                            <div class="input-group">
                                                <select class="form-control border-0 shadow" id="mom-eco-memo-business-channel">
                                                    <option value="">National</option>
                                                    <option value="GT">GT</option>
                                                    <option value="MT">Modern Trade</option>
                                                    <option value="INSTITUTION">Institution</option>

                                                </select>
                                            </div>
                                        </div>
                                    </div>

                                </div><!-- end card header -->



                                <div class="card-body p-0 pb-2">


                                    <div class="w-100">
                                        <div id="mom_eco_memo_business_progress" style="height:400"
                                             data-colors='["--vz-primary","--vz-light",  "--vz-secondary"]'
                                             class="apex-charts" dir="ltr"></div>
                                    </div>




                                </div><!-- end card body -->
                            </div><!-- end card -->




                            <div class="row">
                                <div class="col-xl-8">
                                    <div class="card">
                                        <div class="card-header border-0 align-items-center d-flex">
                                            <h4 class="card-title mb-0 flex-grow-1">Commission Dealer (CD)  MoM Business Progress</h4>
                                            <div class="flex-shrink-0" style="margin-right: 2em">
                                                <div class="input-group">
                                                    <input type="month" id="mom-business-progress-date"
                                                           class="form-control border-0 dash-filter-picker shadow" value="@dt.ToString("yyyy-MM")" />
                                                </div>
                                            </div>
                                            <div class="flex-shrink-0" style="margin-right: 2em">
                                                <div class="flex-shrink-0" style="margin-right: 2em">
                                                    <div class="input-group">
                                                        <select class="form-control border-0 shadow" id="mom-business-channel">
                                                            <option value="">National</option>
                                                            <option value="GT">GT</option>
                                                            <option value="MT">Modern Trade</option>
                                                            <option value="INSTITUTION">Institution</option>

                                                        </select>
                                                    </div>
                                                </div>
                                            </div>

                                            @*<div class="flex-shrink-0" style="margin-right: 2em">
                                                    <div class="flex-shrink-0" style="margin-right: 2em">
                                                        <div class="input-group">
                                                            <select class="form-control border-0 shadow" id="mom-no-months">
                                                                <option value="12">12</option>
                                                                <option value="18">18</option>
                                                                <option value="24">24</option>

                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>*@


                                        </div><!-- end card header -->



                                        <div class="card-body p-0 pb-2">
                                            @*<div class="w-100">
                                                    <div id="customer_impression_charts"
                                                         data-colors='["--vz-light", "--vz-primary", "--vz-secondary"]'
                                                         class="apex-charts" dir="ltr"></div>
                                                </div>*@
                                            <div class="w-100">
                                                <div id="cd_mom_business_progress" style="height:400px"
                                                     data-colors='["--vz-primary","--vz-light",  "--vz-secondary"]'
                                                     class="apex-charts" dir="ltr"></div>
                                            </div>



                                        </div><!-- end card body -->
                                    </div><!-- end card -->
                                </div><!-- end col -->

                                <div class="col-xl-4">
                                    <!-- card -->
                                    <div class="card card-height-100">
                                        <div class="card-header align-items-center d-flex">
                                            <h4 class="card-title mb-0 flex-grow-1">Sales Acheive by Region</h4>
                                            <div class="flex-shrink-0" style="margin-right: 2em">
                                                <div class="input-group">
                                                    <input type="month" id="RegionSalesTargetAchieve_date"
                                                           class="form-control border-0 dash-filter-picker shadow" value="@dt.ToString("yyyy-MM")" />
                                                </div>
                                            </div>

                                        </div><!-- end card header -->
                                        <!-- card body -->
                                        <div class="card-body">



                                            <div class="px-2 py-2 mt-1" id="RegionSalesTargetAchieve">

                                            </div>
                                        </div>
                                        <!-- end card body -->
                                    </div>
                                    <!-- end card -->
                                </div>
                                <!-- end col -->
                            </div>




                            <div class="card">
                                <div class="card-header border-0 align-items-center d-flex">
                                    <h4 class="card-title mb-0 flex-grow-1">MoM Region ECO Business Progress</h4>
                                    <div class="flex-shrink-0" style="margin-right: 2em">
                                        <div class="input-group">
                                            <input type="month" id="mom-region-eco-memo-business-progress-date"
                                                   class="form-control border-0 dash-filter-picker shadow" value="@dt.ToString("yyyy-MM")" />
                                        </div>
                                    </div>
                                    <div class="flex-shrink-0" style="margin-right: 2em">
                                        <div class="flex-shrink-0" style="margin-right: 2em">
                                            <div class="input-group">
                                                <select class="form-control border-0 shadow" id="mom-region-eco-memo-business-channel">
                                                    <option value="">National</option>
                                                    <option value="GT">GT</option>
                                                    <option value="MT">Modern Trade</option>
                                                    <option value="INSTITUTION">Institution</option>

                                                </select>
                                            </div>
                                        </div>
                                    </div>




                                </div><!-- end card header -->



                                <div class="card-body p-0 pb-2">

                                    <div class="w-100">


                                        <div id="mom_region_eco_memo_business_progress" style="height:400"
                                             data-colors='["--vz-primary","--vz-light",  "--vz-secondary"]'
                                             class="apex-charts" dir="ltr">

                                        </div>

                                        <div id="quarterly_business_trend" style="height:400"
                                             data-colors='["--vz-primary","--vz-light",  "--vz-secondary"]'
                                             class="apex-charts" dir="ltr"></div>

                                    </div>


                                </div><!-- end card body -->
                            </div><!-- end card -->


                        </div><!-- end col -->

                    </div>

                    <div class="row">

                        <div class="col-xl-6">
                            <div class="card">
                                <div class="card-header align-items-center d-flex">
                                    <h4 class="card-title mb-0 flex-grow-1">Field Structure wise Sales</h4>
                                    <div class="flex-shrink-0">
                                        <div class="dropdown card-header-dropdown">
                                            <a class="text-reset dropdown-btn" href="#"
                                               data-bs-toggle="dropdown" aria-haspopup="true"
                                               aria-expanded="false">
                                                <span class="fw-semibold text-uppercase fs-12">
                                                    Sort by:
                                                </span><span class="text-muted">
                                                    Today<i class="mdi mdi-chevron-down ms-1"></i>
                                                </span>
                                            </a>
                                            <div class="dropdown-menu dropdown-menu-end">
                                                <a class="dropdown-item" href="#">Today</a>
                                                <a class="dropdown-item" href="#">Yesterday</a>
                                                <a class="dropdown-item" href="#">Last 7 Days</a>
                                                <a class="dropdown-item" href="#">Last 30 Days</a>
                                                <a class="dropdown-item" href="#">This Month</a>
                                                <a class="dropdown-item" href="#">Last Month</a>
                                            </div>
                                        </div>
                                    </div>
                                </div><!-- end card header -->

                                <div class="card-body">
                                    <div class="table-responsive table-card">

                                        <table id="field_strudcture_wise_sales" class="table table-bordered table-centered align-middle table-nowrap mb-0">
                                            <thead>
                                                <tr>
                                                    <th>Region</th>
                                                    <th>
                                                        Area
                                                    </th>
                                                    <th>Territory</th>
                                                    <th>Dealer</th>
                                                    <th>Sales Amount[TP]</th>
                                                </tr>
                                            </thead>
                                            <tbody id="field_strudcture_wise_sales_table_body">
                                                <!-- Dynamic content goes here -->
                                            </tbody>
                                        </table>

                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-xl-6">
                            <div class="card">
                                <div class="card-header align-items-center d-flex">
                                    <h4 class="card-title mb-0 flex-grow-1">Route wise Outlet wise Sales [<span id="dealer_info"></span>]</h4>

                                    <div class="flex-shrink-0">
                                        <div class="dropdown card-header-dropdown">
                                            <a class="text-reset dropdown-btn" href="#"
                                               data-bs-toggle="dropdown" aria-haspopup="true"
                                               aria-expanded="false">
                                                <span class="fw-semibold text-uppercase fs-12">
                                                    Sort by:
                                                </span><span class="text-muted">
                                                    Today<i class="mdi mdi-chevron-down ms-1"></i>
                                                </span>
                                            </a>
                                            <div class="dropdown-menu dropdown-menu-end">
                                                <a class="dropdown-item" href="#">Today</a>
                                                <a class="dropdown-item" href="#">Yesterday</a>
                                                <a class="dropdown-item" href="#">Last 7 Days</a>
                                                <a class="dropdown-item" href="#">Last 30 Days</a>
                                                <a class="dropdown-item" href="#">This Month</a>
                                                <a class="dropdown-item" href="#">Last Month</a>
                                            </div>
                                        </div>
                                    </div>
                                </div><!-- end card header -->

                                <div class="card-body">
                                    <div class="table-responsive table-card">

                                        <table id="routeSalesStatusTable" class="table table-hover table-centered align-middle table-nowrap mb-0">
                                            <thead>
                                                <tr>
                                                    <th>ROUTE</th>
                                                    <th>Outlet</th>
                                                    <th>Total TP Sales</th>
                                                    <th>Total Memo</th>
                                                    <th>Sales Months</th>
                                                    <th>Average / Month</th>
                                                </tr>
                                            </thead>
                                            <tbody></tbody>
                                        </table>

                                    </div>
                                </div>
                            </div>
                        </div>


                    </div> <!-- end row-->


                    <div class="row">
                        <div class="col-xl-8">
                            <div class="card">
                                <div class="card-header border-0 align-items-center d-flex">
                                    <h4 class="card-title mb-0 flex-grow-1">MoM Business Progress (GT+MT+INST)</h4>
                                    <div>
                                        <button type="button" class="btn btn-soft-secondary btn-sm">
                                            ALL
                                        </button>
                                        <button type="button" class="btn btn-soft-secondary btn-sm">
                                            1M
                                        </button>
                                        <button type="button" class="btn btn-soft-secondary btn-sm">
                                            6M
                                        </button>
                                        <button type="button" class="btn btn-soft-primary btn-sm">
                                            1Y
                                        </button>
                                    </div>
                                </div><!-- end card header -->

                                <div class="card-header p-0 border-0 bg-light-subtle">
                                    <div class="row g-0 text-center">
                                        <div class="col-6 col-sm-3">
                                            <div class="p-3 border border-dashed border-start-0">
                                                <h5 class="mb-1">
                                                    <span class="counter-value"
                                                          data-target="7585">0</span>
                                                </h5>
                                                <p class="text-muted mb-0">Orders</p>
                                            </div>
                                        </div>
                                        <!--end col-->
                                        <div class="col-6 col-sm-3">
                                            <div class="p-3 border border-dashed border-start-0">
                                                <h5 class="mb-1">
                                                    $<span class="counter-value"
                                                           data-target="22.89">0</span>k
                                                </h5>
                                                <p class="text-muted mb-0">Earnings</p>
                                            </div>
                                        </div>
                                        <!--end col-->
                                        <div class="col-6 col-sm-3">
                                            <div class="p-3 border border-dashed border-start-0">
                                                <h5 class="mb-1">
                                                    <span class="counter-value"
                                                          data-target="367">0</span>
                                                </h5>
                                                <p class="text-muted mb-0">Refunds</p>
                                            </div>
                                        </div>
                                        <!--end col-->
                                        <div class="col-6 col-sm-3">
                                            <div class="p-3 border border-dashed border-start-0 border-end-0">
                                                <h5 class="mb-1 text-success">
                                                    <span class="counter-value"
                                                          data-target="18.92">0</span>%
                                                </h5>
                                                <p class="text-muted mb-0">Conversation Ratio</p>
                                            </div>
                                        </div>
                                        <!--end col-->
                                    </div>
                                </div><!-- end card header -->

                                <div class="card-body p-0 pb-2">
                                    <div class="w-100">
                                        <div id="customer_impression_charts"
                                             data-colors='["--vz-light", "--vz-primary", "--vz-secondary"]'
                                             class="apex-charts" dir="ltr"></div>
                                    </div>
                                </div><!-- end card body -->
                            </div><!-- end card -->
                        </div><!-- end col -->

                        <div class="col-xl-4">
                            <!-- card -->
                            <div class="card card-height-100">
                                <div class="card-header align-items-center d-flex">
                                    <h4 class="card-title mb-0 flex-grow-1">Sales by Locations</h4>
                                    <div class="flex-shrink-0">
                                        <button type="button" class="btn btn-soft-primary btn-sm">
                                            Export Report
                                        </button>
                                    </div>
                                </div><!-- end card header -->
                                <!-- card body -->
                                <div class="card-body">

                                    <div id="sales-by-locations"
                                         data-colors='["--vz-light", "--vz-success", "--vz-primary"]'
                                         style="height: 269px" dir="ltr"></div>

                                    <div class="px-2 py-2 mt-1">
                                        <p class="mb-1">Canada <span class="float-end">75%</span></p>
                                        <div class="progress mt-2" style="height: 6px;">
                                            <div class="progress-bar progress-bar-striped bg-primary"
                                                 role="progressbar" style="width: 75%" aria-valuenow="75"
                                                 aria-valuemin="0" aria-valuemax="75"></div>
                                        </div>

                                        <p class="mt-3 mb-1">
                                            Greenland <span class="float-end">47%</span>
                                        </p>
                                        <div class="progress mt-2" style="height: 6px;">
                                            <div class="progress-bar progress-bar-striped bg-primary"
                                                 role="progressbar" style="width: 47%" aria-valuenow="47"
                                                 aria-valuemin="0" aria-valuemax="47"></div>
                                        </div>

                                        <p class="mt-3 mb-1">Russia <span class="float-end">82%</span></p>
                                        <div class="progress mt-2" style="height: 6px;">
                                            <div class="progress-bar progress-bar-striped bg-primary"
                                                 role="progressbar" style="width: 82%" aria-valuenow="82"
                                                 aria-valuemin="0" aria-valuemax="82"></div>
                                        </div>
                                    </div>
                                </div>
                                <!-- end card body -->
                            </div>
                            <!-- end card -->
                        </div>
                        <!-- end col -->
                    </div>

                    <div class="row">
                        <div class="col-xl-6">
                            <div class="card">
                                <div class="card-header align-items-center d-flex">
                                    <h4 class="card-title mb-0 flex-grow-1">Best Selling Products</h4>
                                    <div class="flex-shrink-0">
                                        <div class="dropdown card-header-dropdown">
                                            <a class="text-reset dropdown-btn" href="#"
                                               data-bs-toggle="dropdown" aria-haspopup="true"
                                               aria-expanded="false">
                                                <span class="fw-semibold text-uppercase fs-12">
                                                    Sort by:
                                                </span><span class="text-muted">
                                                    Today<i class="mdi mdi-chevron-down ms-1"></i>
                                                </span>
                                            </a>
                                            <div class="dropdown-menu dropdown-menu-end">
                                                <a class="dropdown-item" href="#">Today</a>
                                                <a class="dropdown-item" href="#">Yesterday</a>
                                                <a class="dropdown-item" href="#">Last 7 Days</a>
                                                <a class="dropdown-item" href="#">Last 30 Days</a>
                                                <a class="dropdown-item" href="#">This Month</a>
                                                <a class="dropdown-item" href="#">Last Month</a>
                                            </div>
                                        </div>
                                    </div>
                                </div><!-- end card header -->

                                <div class="card-body">
                                    <div class="table-responsive table-card">
                                        <table class="table table-hover table-centered align-middle table-nowrap mb-0">
                                            <tbody>
                                                <tr>
                                                    <td>
                                                        <div class="d-flex align-items-center">
                                                            <div class="avatar-sm bg-light rounded p-1 me-2">
                                                                <img src="Content/assets/images/products/img-1.png"
                                                                     alt="" class="img-fluid d-block" />
                                                            </div>
                                                            <div>
                                                                <h5 class="fs-14 my-1">
                                                                    <a href="apps-ecommerce-product-details.html"
                                                                       class="text-reset">
                                                                        Branded
                                                                        T-Shirts
                                                                    </a>
                                                                </h5>
                                                                <span class="text-muted">24 Apr 2021</span>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <h5 class="fs-14 my-1 fw-normal">$29.00</h5>
                                                        <span class="text-muted">Price</span>
                                                    </td>
                                                    <td>
                                                        <h5 class="fs-14 my-1 fw-normal">62</h5>
                                                        <span class="text-muted">Orders</span>
                                                    </td>
                                                    <td>
                                                        <h5 class="fs-14 my-1 fw-normal">510</h5>
                                                        <span class="text-muted">Stock</span>
                                                    </td>
                                                    <td>
                                                        <h5 class="fs-14 my-1 fw-normal">$1,798</h5>
                                                        <span class="text-muted">Amount</span>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <div class="d-flex align-items-center">
                                                            <div class="avatar-sm bg-light rounded p-1 me-2">
                                                                <img src="Content/assets/images/products/img-2.png"
                                                                     alt="" class="img-fluid d-block" />
                                                            </div>
                                                            <div>
                                                                <h5 class="fs-14 my-1">
                                                                    <a href="apps-ecommerce-product-details.html"
                                                                       class="text-reset">
                                                                        Bentwood
                                                                        Chair
                                                                    </a>
                                                                </h5>
                                                                <span class="text-muted">19 Mar 2021</span>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <h5 class="fs-14 my-1 fw-normal">$85.20</h5>
                                                        <span class="text-muted">Price</span>
                                                    </td>
                                                    <td>
                                                        <h5 class="fs-14 my-1 fw-normal">35</h5>
                                                        <span class="text-muted">Orders</span>
                                                    </td>
                                                    <td>
                                                        <h5 class="fs-14 my-1 fw-normal">
                                                            <span class="badge bg-danger-subtle text-danger">
                                                                Out
                                                                of stock
                                                            </span>
                                                        </h5>
                                                        <span class="text-muted">Stock</span>
                                                    </td>
                                                    <td>
                                                        <h5 class="fs-14 my-1 fw-normal">$2982</h5>
                                                        <span class="text-muted">Amount</span>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <div class="d-flex align-items-center">
                                                            <div class="avatar-sm bg-light rounded p-1 me-2">
                                                                <img src="Content/assets/images/products/img-3.png"
                                                                     alt="" class="img-fluid d-block" />
                                                            </div>
                                                            <div>
                                                                <h5 class="fs-14 my-1">
                                                                    <a href="apps-ecommerce-product-details.html"
                                                                       class="text-reset">
                                                                        Borosil Paper
                                                                        Cup
                                                                    </a>
                                                                </h5>
                                                                <span class="text-muted">01 Mar 2021</span>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <h5 class="fs-14 my-1 fw-normal">$14.00</h5>
                                                        <span class="text-muted">Price</span>
                                                    </td>
                                                    <td>
                                                        <h5 class="fs-14 my-1 fw-normal">80</h5>
                                                        <span class="text-muted">Orders</span>
                                                    </td>
                                                    <td>
                                                        <h5 class="fs-14 my-1 fw-normal">749</h5>
                                                        <span class="text-muted">Stock</span>
                                                    </td>
                                                    <td>
                                                        <h5 class="fs-14 my-1 fw-normal">$1120</h5>
                                                        <span class="text-muted">Amount</span>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <div class="d-flex align-items-center">
                                                            <div class="avatar-sm bg-light rounded p-1 me-2">
                                                                <img src="Content/assets/images/products/img-4.png"
                                                                     alt="" class="img-fluid d-block" />
                                                            </div>
                                                            <div>
                                                                <h5 class="fs-14 my-1">
                                                                    <a href="apps-ecommerce-product-details.html"
                                                                       class="text-reset">
                                                                        One Seater
                                                                        Sofa
                                                                    </a>
                                                                </h5>
                                                                <span class="text-muted">11 Feb 2021</span>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <h5 class="fs-14 my-1 fw-normal">$127.50</h5>
                                                        <span class="text-muted">Price</span>
                                                    </td>
                                                    <td>
                                                        <h5 class="fs-14 my-1 fw-normal">56</h5>
                                                        <span class="text-muted">Orders</span>
                                                    </td>
                                                    <td>
                                                        <h5 class="fs-14 my-1 fw-normal">
                                                            <span class="badge bg-danger-subtle text-danger">
                                                                Out
                                                                of stock
                                                            </span>
                                                        </h5>
                                                        <span class="text-muted">Stock</span>
                                                    </td>
                                                    <td>
                                                        <h5 class="fs-14 my-1 fw-normal">$7140</h5>
                                                        <span class="text-muted">Amount</span>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <div class="d-flex align-items-center">
                                                            <div class="avatar-sm bg-light rounded p-1 me-2">
                                                                <img src="Content/assets/images/products/img-5.png"
                                                                     alt="" class="img-fluid d-block" />
                                                            </div>
                                                            <div>
                                                                <h5 class="fs-14 my-1">
                                                                    <a href="apps-ecommerce-product-details.html"
                                                                       class="text-reset">
                                                                        Stillbird
                                                                        Helmet
                                                                    </a>
                                                                </h5>
                                                                <span class="text-muted">17 Jan 2021</span>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <h5 class="fs-14 my-1 fw-normal">$54</h5>
                                                        <span class="text-muted">Price</span>
                                                    </td>
                                                    <td>
                                                        <h5 class="fs-14 my-1 fw-normal">74</h5>
                                                        <span class="text-muted">Orders</span>
                                                    </td>
                                                    <td>
                                                        <h5 class="fs-14 my-1 fw-normal">805</h5>
                                                        <span class="text-muted">Stock</span>
                                                    </td>
                                                    <td>
                                                        <h5 class="fs-14 my-1 fw-normal">$3996</h5>
                                                        <span class="text-muted">Amount</span>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>

                                    <div class="align-items-center mt-4 pt-2 justify-content-between row text-center text-sm-start">
                                        <div class="col-sm">
                                            <div class="text-muted">
                                                Showing <span class="fw-semibold">5</span> of <span class="fw-semibold">25</span> Results
                                            </div>
                                        </div>
                                        <div class="col-sm-auto  mt-3 mt-sm-0">
                                            <ul class="pagination pagination-separated pagination-sm mb-0 justify-content-center">
                                                <li class="page-item disabled">
                                                    <a href="#" class="page-link">←</a>
                                                </li>
                                                <li class="page-item">
                                                    <a href="#" class="page-link">1</a>
                                                </li>
                                                <li class="page-item active">
                                                    <a href="#" class="page-link">2</a>
                                                </li>
                                                <li class="page-item">
                                                    <a href="#" class="page-link">3</a>
                                                </li>
                                                <li class="page-item">
                                                    <a href="#" class="page-link">→</a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>

                        <div class="col-xl-6">
                            <div class="card card-height-100">
                                <div class="card-header align-items-center d-flex">
                                    <h4 class="card-title mb-0 flex-grow-1">Top Sellers</h4>
                                    <div class="flex-shrink-0">
                                        <div class="dropdown card-header-dropdown">
                                            <a class="text-reset dropdown-btn" href="#"
                                               data-bs-toggle="dropdown" aria-haspopup="true"
                                               aria-expanded="false">
                                                <span class="text-muted">
                                                    Report<i class="mdi mdi-chevron-down ms-1"></i>
                                                </span>
                                            </a>
                                            <div class="dropdown-menu dropdown-menu-end">
                                                <a class="dropdown-item" href="#">Download Report</a>
                                                <a class="dropdown-item" href="#">Export</a>
                                                <a class="dropdown-item" href="#">Import</a>
                                            </div>
                                        </div>
                                    </div>
                                </div><!-- end card header -->

                                <div class="card-body">
                                    <div class="table-responsive table-card">
                                        <table class="table table-centered table-hover align-middle table-nowrap mb-0">
                                            <tbody>
                                                <tr>
                                                    <td>
                                                        <div class="d-flex align-items-center">
                                                            <div class="flex-shrink-0 me-2">
                                                                <img src="Content/assets/images/companies/img-1.png"
                                                                     alt="" class="avatar-sm p-2" />
                                                            </div>
                                                            <div>
                                                                <h5 class="fs-14 my-1">
                                                                    <a href="apps-ecommerce-seller-details.html"
                                                                       class="text-reset">iTest Factory</a>
                                                                </h5>
                                                                <span class="text-muted">Oliver Tyler</span>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <span class="text-muted">Bags and Wallets</span>
                                                    </td>
                                                    <td>
                                                        <p class="mb-0">8547</p>
                                                        <span class="text-muted">Stock</span>
                                                    </td>
                                                    <td>
                                                        <span class="text-muted">$541200</span>
                                                    </td>
                                                    <td>
                                                        <h5 class="fs-14 mb-0">
                                                            32%<i class="ri-bar-chart-fill text-success fs-16 align-middle ms-2"></i>
                                                        </h5>
                                                    </td>
                                                </tr><!-- end -->
                                                <tr>
                                                    <td>
                                                        <div class="d-flex align-items-center">
                                                            <div class="flex-shrink-0 me-2">
                                                                <img src="Content/assets/images/companies/img-2.png"
                                                                     alt="" class="avatar-sm p-2" />
                                                            </div>
                                                            <div class="flex-grow-1">
                                                                <h5 class="fs-14 my-1">
                                                                    <a href="apps-ecommerce-seller-details.html"
                                                                       class="text-reset">
                                                                        Digitech
                                                                        Galaxy
                                                                    </a>
                                                                </h5>
                                                                <span class="text-muted">John Roberts</span>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <span class="text-muted">Watches</span>
                                                    </td>
                                                    <td>
                                                        <p class="mb-0">895</p>
                                                        <span class="text-muted">Stock</span>
                                                    </td>
                                                    <td>
                                                        <span class="text-muted">$75030</span>
                                                    </td>
                                                    <td>
                                                        <h5 class="fs-14 mb-0">
                                                            79%<i class="ri-bar-chart-fill text-success fs-16 align-middle ms-2"></i>
                                                        </h5>
                                                    </td>
                                                </tr><!-- end -->
                                                <tr>
                                                    <td>
                                                        <div class="d-flex align-items-center">
                                                            <div class="flex-shrink-0 me-2">
                                                                <img src="Content/assets/images/companies/img-3.png"
                                                                     alt="" class="avatar-sm p-2" />
                                                            </div>
                                                            <div class="flex-gow-1">
                                                                <h5 class="fs-14 my-1">
                                                                    <a href="apps-ecommerce-seller-details.html"
                                                                       class="text-reset">
                                                                        Nesta
                                                                        Technologies
                                                                    </a>
                                                                </h5>
                                                                <span class="text-muted">
                                                                    Harley
                                                                    Fuller
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <span class="text-muted">Bike Accessories</span>
                                                    </td>
                                                    <td>
                                                        <p class="mb-0">3470</p>
                                                        <span class="text-muted">Stock</span>
                                                    </td>
                                                    <td>
                                                        <span class="text-muted">$45600</span>
                                                    </td>
                                                    <td>
                                                        <h5 class="fs-14 mb-0">
                                                            90%<i class="ri-bar-chart-fill text-success fs-16 align-middle ms-2"></i>
                                                        </h5>
                                                    </td>
                                                </tr><!-- end -->
                                                <tr>
                                                    <td>
                                                        <div class="d-flex align-items-center">
                                                            <div class="flex-shrink-0 me-2">
                                                                <img src="Content/assets/images/companies/img-8.png"
                                                                     alt="" class="avatar-sm p-2" />
                                                            </div>
                                                            <div class="flex-grow-1">
                                                                <h5 class="fs-14 my-1">
                                                                    <a href="apps-ecommerce-seller-details.html"
                                                                       class="text-reset">
                                                                        Zoetic
                                                                        Fashion
                                                                    </a>
                                                                </h5>
                                                                <span class="text-muted">James Bowen</span>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <span class="text-muted">Clothes</span>
                                                    </td>
                                                    <td>
                                                        <p class="mb-0">5488</p>
                                                        <span class="text-muted">Stock</span>
                                                    </td>
                                                    <td>
                                                        <span class="text-muted">$29456</span>
                                                    </td>
                                                    <td>
                                                        <h5 class="fs-14 mb-0">
                                                            40%<i class="ri-bar-chart-fill text-success fs-16 align-middle ms-2"></i>
                                                        </h5>
                                                    </td>
                                                </tr><!-- end -->
                                                <tr>
                                                    <td>
                                                        <div class="d-flex align-items-center">
                                                            <div class="flex-shrink-0 me-2">
                                                                <img src="Content/assets/images/companies/img-5.png"
                                                                     alt="" class="avatar-sm p-2" />
                                                            </div>
                                                            <div class="flex-grow-1">
                                                                <h5 class="fs-14 my-1">
                                                                    <a href="apps-ecommerce-seller-details.html"
                                                                       class="text-reset">Meta4Systems</a>
                                                                </h5>
                                                                <span class="text-muted">Zoe Dennis</span>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <span class="text-muted">Furniture</span>
                                                    </td>
                                                    <td>
                                                        <p class="mb-0">4100</p>
                                                        <span class="text-muted">Stock</span>
                                                    </td>
                                                    <td>
                                                        <span class="text-muted">$11260</span>
                                                    </td>
                                                    <td>
                                                        <h5 class="fs-14 mb-0">
                                                            57%<i class="ri-bar-chart-fill text-success fs-16 align-middle ms-2"></i>
                                                        </h5>
                                                    </td>
                                                </tr><!-- end -->
                                            </tbody>
                                        </table><!-- end table -->
                                    </div>

                                    <div class="align-items-center mt-4 pt-2 justify-content-between row text-center text-sm-start">
                                        <div class="col-sm">
                                            <div class="text-muted">
                                                Showing <span class="fw-semibold">5</span> of <span class="fw-semibold">25</span> Results
                                            </div>
                                        </div>
                                        <div class="col-sm-auto  mt-3 mt-sm-0">
                                            <ul class="pagination pagination-separated pagination-sm mb-0 justify-content-center">
                                                <li class="page-item disabled">
                                                    <a href="#" class="page-link">←</a>
                                                </li>
                                                <li class="page-item">
                                                    <a href="#" class="page-link">1</a>
                                                </li>
                                                <li class="page-item active">
                                                    <a href="#" class="page-link">2</a>
                                                </li>
                                                <li class="page-item">
                                                    <a href="#" class="page-link">3</a>
                                                </li>
                                                <li class="page-item">
                                                    <a href="#" class="page-link">→</a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>

                                </div> <!-- .card-body-->
                            </div> <!-- .card-->
                        </div> <!-- .col-->
                    </div> <!-- end row-->



                </div> <!-- end .h-100-->

            </div> <!-- end col -->

            <div class="col-auto layout-rightside-col d-none">
                <div class="overlay"></div>
                <div class="layout-rightside">
                    <div class="card h-100 rounded-0">
                        <div class="card-body p-0">
                            <div class="p-3">
                                <h6 class="text-muted mb-0 text-uppercase fw-semibold">Recent Activity</h6>
                            </div>
                            <div data-simplebar style="max-height: 410px;" class="p-3 pt-0">
                                <div class="acitivity-timeline acitivity-main">
                                    <div class="acitivity-item d-flex">
                                        <div class="flex-shrink-0 avatar-xs acitivity-avatar">
                                            <div class="avatar-title bg-success-subtle text-success rounded-circle">
                                                <i class="ri-shopping-cart-2-line"></i>
                                            </div>
                                        </div>
                                        <div class="flex-grow-1 ms-3">
                                            <h6 class="mb-1 lh-base">Purchase by James Price</h6>
                                            <p class="text-muted mb-1">Product noise evolve smartwatch </p>
                                            <small class="mb-0 text-muted">02:14 PM Today</small>
                                        </div>
                                    </div>
                                    <div class="acitivity-item py-3 d-flex">
                                        <div class="flex-shrink-0 avatar-xs acitivity-avatar">
                                            <div class="avatar-title bg-danger-subtle text-danger rounded-circle">
                                                <i class="ri-stack-fill"></i>
                                            </div>
                                        </div>
                                        <div class="flex-grow-1 ms-3">
                                            <h6 class="mb-1 lh-base">
                                                Added new <span class="fw-semibold">style collection</span>
                                            </h6>
                                            <p class="text-muted mb-1">By Nesta Technologies</p>
                                            <div class="d-inline-flex gap-2 border border-dashed p-2 mb-2">
                                                <a href="apps-ecommerce-product-details.html"
                                                   class="bg-light rounded p-1">
                                                    <img src="Content/assets/images/products/img-8.png" alt=""
                                                         class="img-fluid d-block" />
                                                </a>
                                                <a href="apps-ecommerce-product-details.html"
                                                   class="bg-light rounded p-1">
                                                    <img src="Content/assets/images/products/img-2.png" alt=""
                                                         class="img-fluid d-block" />
                                                </a>
                                                <a href="apps-ecommerce-product-details.html"
                                                   class="bg-light rounded p-1">
                                                    <img src="Content/assets/images/products/img-10.png" alt=""
                                                         class="img-fluid d-block" />
                                                </a>
                                            </div>
                                            <p class="mb-0 text-muted"><small>9:47 PM Yesterday</small></p>
                                        </div>
                                    </div>
                                    <div class="acitivity-item py-3 d-flex">
                                        <div class="flex-shrink-0">
                                            <img src="Content/assets/images/users/avatar-2.jpg" alt=""
                                                 class="avatar-xs rounded-circle acitivity-avatar">
                                        </div>
                                        <div class="flex-grow-1 ms-3">
                                            <h6 class="mb-1 lh-base">
                                                Natasha Carey have liked the products
                                            </h6>
                                            <p class="text-muted mb-1">
                                                Allow users to like products in your
                                                WooCommerce store.
                                            </p>
                                            <small class="mb-0 text-muted">25 Dec, 2021</small>
                                        </div>
                                    </div>
                                    <div class="acitivity-item py-3 d-flex">
                                        <div class="flex-shrink-0">
                                            <div class="avatar-xs acitivity-avatar">
                                                <div class="avatar-title rounded-circle bg-secondary">
                                                    <i class="mdi mdi-sale fs-14"></i>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="flex-grow-1 ms-3">
                                            <h6 class="mb-1 lh-base">
                                                Today offers by <a href="apps-ecommerce-seller-details.html"
                                                                   class="link-secondary">Digitech Galaxy</a>
                                            </h6>
                                            <p class="text-muted mb-2">
                                                Offer is valid on orders of Rs.500 Or
                                                above for selected products only.
                                            </p>
                                            <small class="mb-0 text-muted">12 Dec, 2021</small>
                                        </div>
                                    </div>
                                    <div class="acitivity-item py-3 d-flex">
                                        <div class="flex-shrink-0">
                                            <div class="avatar-xs acitivity-avatar">
                                                <div class="avatar-title rounded-circle bg-danger-subtle text-danger">
                                                    <i class="ri-bookmark-fill"></i>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="flex-grow-1 ms-3">
                                            <h6 class="mb-1 lh-base">Favorite Product</h6>
                                            <p class="text-muted mb-2">
                                                Esther James have Favorite product.
                                            </p>
                                            <small class="mb-0 text-muted">25 Nov, 2021</small>
                                        </div>
                                    </div>
                                    <div class="acitivity-item py-3 d-flex">
                                        <div class="flex-shrink-0">
                                            <div class="avatar-xs acitivity-avatar">
                                                <div class="avatar-title rounded-circle bg-secondary">
                                                    <i class="mdi mdi-sale fs-14"></i>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="flex-grow-1 ms-3">
                                            <h6 class="mb-1 lh-base">
                                                Flash sale starting <span class="text-primary">Tomorrow.</span>
                                            </h6>
                                            <p class="text-muted mb-0">
                                                Flash sale by <a href="javascript:void(0);"
                                                                 class="link-secondary fw-medium">Zoetic Fashion</a>
                                            </p>
                                            <small class="mb-0 text-muted">22 Oct, 2021</small>
                                        </div>
                                    </div>
                                    <div class="acitivity-item py-3 d-flex">
                                        <div class="flex-shrink-0">
                                            <div class="avatar-xs acitivity-avatar">
                                                <div class="avatar-title rounded-circle bg-info-subtle text-info">
                                                    <i class="ri-line-chart-line"></i>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="flex-grow-1 ms-3">
                                            <h6 class="mb-1 lh-base">Monthly sales report</h6>
                                            <p class="text-muted mb-2">
                                                <span class="text-danger">
                                                    2 days
                                                    left
                                                </span> notification to submit the monthly sales
                                                report. <a href="javascript:void(0);"
                                                           class="link-warning text-decoration-underline">
                                                    Reports
                                                    Builder
                                                </a>
                                            </p>
                                            <small class="mb-0 text-muted">15 Oct</small>
                                        </div>
                                    </div>
                                    <div class="acitivity-item d-flex">
                                        <div class="flex-shrink-0">
                                            <img src="Content/assets/images/users/avatar-3.jpg" alt=""
                                                 class="avatar-xs rounded-circle acitivity-avatar" />
                                        </div>
                                        <div class="flex-grow-1 ms-3">
                                            <h6 class="mb-1 lh-base">Frank Hook Commented</h6>
                                            <p class="text-muted mb-2 fst-italic">
                                                " A product that has
                                                reviews is more likable to be sold than a product. "
                                            </p>
                                            <small class="mb-0 text-muted">26 Aug, 2021</small>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="p-3 mt-2">
                                <h6 class="text-muted mb-3 text-uppercase fw-semibold">
                                    Top 10 Categories
                                </h6>

                                <ol class="ps-3 text-muted">
                                    <li class="py-1">
                                        <a href="#" class="text-muted">
                                            Mobile & Accessories <span class="float-end">(10,294)</span>
                                        </a>
                                    </li>
                                    <li class="py-1">
                                        <a href="#" class="text-muted">
                                            Desktop <span class="float-end">(6,256)</span>
                                        </a>
                                    </li>
                                    <li class="py-1">
                                        <a href="#" class="text-muted">
                                            Electronics <span class="float-end">(3,479)</span>
                                        </a>
                                    </li>
                                    <li class="py-1">
                                        <a href="#" class="text-muted">
                                            Home & Furniture <span class="float-end">(2,275)</span>
                                        </a>
                                    </li>
                                    <li class="py-1">
                                        <a href="#" class="text-muted">
                                            Grocery <span class="float-end">(1,950)</span>
                                        </a>
                                    </li>
                                    <li class="py-1">
                                        <a href="#" class="text-muted">
                                            Fashion <span class="float-end">(1,582)</span>
                                        </a>
                                    </li>
                                    <li class="py-1">
                                        <a href="#" class="text-muted">
                                            Appliances <span class="float-end">(1,037)</span>
                                        </a>
                                    </li>
                                    <li class="py-1">
                                        <a href="#" class="text-muted">
                                            Beauty, Toys & More <span class="float-end">(924)</span>
                                        </a>
                                    </li>
                                    <li class="py-1">
                                        <a href="#" class="text-muted">
                                            Food & Drinks <span class="float-end">(701)</span>
                                        </a>
                                    </li>
                                    <li class="py-1">
                                        <a href="#" class="text-muted">
                                            Toys & Games <span class="float-end">(239)</span>
                                        </a>
                                    </li>
                                </ol>
                                <div class="mt-3 text-center">
                                    <a href="javascript:void(0);"
                                       class="text-muted text-decoration-underline">View all Categories</a>
                                </div>
                            </div>
                            <div class="p-3">
                                <h6 class="text-muted mb-3 text-uppercase fw-semibold">Products Reviews</h6>
                                <!-- Swiper -->
                                <div class="swiper vertical-swiper" style="height: 250px;">
                                    <div class="swiper-wrapper">
                                        <div class="swiper-slide">
                                            <div class="card border border-dashed shadow-none">
                                                <div class="card-body">
                                                    <div class="d-flex">
                                                        <div class="flex-shrink-0 avatar-sm">
                                                            <div class="avatar-title bg-light rounded">
                                                                <img src="Content/assets/images/companies/img-1.png"
                                                                     alt="" height="30">
                                                            </div>
                                                        </div>
                                                        <div class="flex-grow-1 ms-3">
                                                            <div>
                                                                <p class="text-muted mb-1 fst-italic text-truncate-two-lines">
                                                                    " Great product and looks great, lots of
                                                                    features. "
                                                                </p>
                                                                <div class="fs-11 align-middle text-warning">
                                                                    <i class="ri-star-fill"></i>
                                                                    <i class="ri-star-fill"></i>
                                                                    <i class="ri-star-fill"></i>
                                                                    <i class="ri-star-fill"></i>
                                                                    <i class="ri-star-fill"></i>
                                                                </div>
                                                            </div>
                                                            <div class="text-end mb-0 text-muted">
                                                                - by <cite title="Source Title">
                                                                    Force
                                                                    Medicines
                                                                </cite>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="swiper-slide">
                                            <div class="card border border-dashed shadow-none">
                                                <div class="card-body">
                                                    <div class="d-flex">
                                                        <div class="flex-shrink-0">
                                                            <img src="Content/assets/images/users/avatar-3.jpg"
                                                                 alt="" class="avatar-sm rounded">
                                                        </div>
                                                        <div class="flex-grow-1 ms-3">
                                                            <div>
                                                                <p class="text-muted mb-1 fst-italic text-truncate-two-lines">
                                                                    " Amazing template, very easy to
                                                                    understand and manipulate. "
                                                                </p>
                                                                <div class="fs-11 align-middle text-warning">
                                                                    <i class="ri-star-fill"></i>
                                                                    <i class="ri-star-fill"></i>
                                                                    <i class="ri-star-fill"></i>
                                                                    <i class="ri-star-fill"></i>
                                                                    <i class="ri-star-half-fill"></i>
                                                                </div>
                                                            </div>
                                                            <div class="text-end mb-0 text-muted">
                                                                - by <cite title="Source Title">
                                                                    Henry
                                                                    Baird
                                                                </cite>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="swiper-slide">
                                            <div class="card border border-dashed shadow-none">
                                                <div class="card-body">
                                                    <div class="d-flex">
                                                        <div class="flex-shrink-0 avatar-sm">
                                                            <div class="avatar-title bg-light rounded">
                                                                <img src="Content/assets/images/companies/img-8.png"
                                                                     alt="" height="30">
                                                            </div>
                                                        </div>
                                                        <div class="flex-grow-1 ms-3">
                                                            <div>
                                                                <p class="text-muted mb-1 fst-italic text-truncate-two-lines">
                                                                    "Very beautiful product and Very helpful
                                                                    customer service."
                                                                </p>
                                                                <div class="fs-11 align-middle text-warning">
                                                                    <i class="ri-star-fill"></i>
                                                                    <i class="ri-star-fill"></i>
                                                                    <i class="ri-star-fill"></i>
                                                                    <i class="ri-star-line"></i>
                                                                    <i class="ri-star-line"></i>
                                                                </div>
                                                            </div>
                                                            <div class="text-end mb-0 text-muted">
                                                                - by <cite title="Source Title">
                                                                    Zoetic
                                                                    Fashion
                                                                </cite>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="swiper-slide">
                                            <div class="card border border-dashed shadow-none">
                                                <div class="card-body">
                                                    <div class="d-flex">
                                                        <div class="flex-shrink-0">
                                                            <img src="Content/assets/images/users/avatar-2.jpg"
                                                                 alt="" class="avatar-sm rounded">
                                                        </div>
                                                        <div class="flex-grow-1 ms-3">
                                                            <div>
                                                                <p class="text-muted mb-1 fst-italic text-truncate-two-lines">
                                                                    " The product is very beautiful. I like
                                                                    it. "
                                                                </p>
                                                                <div class="fs-11 align-middle text-warning">
                                                                    <i class="ri-star-fill"></i>
                                                                    <i class="ri-star-fill"></i>
                                                                    <i class="ri-star-fill"></i>
                                                                    <i class="ri-star-half-fill"></i>
                                                                    <i class="ri-star-line"></i>
                                                                </div>
                                                            </div>
                                                            <div class="text-end mb-0 text-muted">
                                                                - by <cite title="Source Title">
                                                                    Nancy
                                                                    Martino
                                                                </cite>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="p-3">
                                <h6 class="text-muted mb-3 text-uppercase fw-semibold">Customer Reviews</h6>
                                <div class="bg-light px-3 py-2 rounded-2 mb-2">
                                    <div class="d-flex align-items-center">
                                        <div class="flex-grow-1">
                                            <div class="fs-16 align-middle text-warning">
                                                <i class="ri-star-fill"></i>
                                                <i class="ri-star-fill"></i>
                                                <i class="ri-star-fill"></i>
                                                <i class="ri-star-fill"></i>
                                                <i class="ri-star-half-fill"></i>
                                            </div>
                                        </div>
                                        <div class="flex-shrink-0">
                                            <h6 class="mb-0">4.5 out of 5</h6>
                                        </div>
                                    </div>
                                </div>
                                <div class="text-center">
                                    <div class="text-muted">
                                        Total <span class="fw-medium">5.50k</span>
                                        reviews
                                    </div>
                                </div>

                                <div class="mt-3">
                                    <div class="row align-items-center g-2">
                                        <div class="col-auto">
                                            <div class="p-1">
                                                <h6 class="mb-0">5 star</h6>
                                            </div>
                                        </div>
                                        <div class="col">
                                            <div class="p-1">
                                                <div class="progress animated-progress progress-sm">
                                                    <div class="progress-bar bg-success" role="progressbar"
                                                         style="width: 50.16%" aria-valuenow="50.16"
                                                         aria-valuemin="0" aria-valuemax="100"></div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-auto">
                                            <div class="p-1">
                                                <h6 class="mb-0 text-muted">2758</h6>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- end row -->

                                    <div class="row align-items-center g-2">
                                        <div class="col-auto">
                                            <div class="p-1">
                                                <h6 class="mb-0">4 star</h6>
                                            </div>
                                        </div>
                                        <div class="col">
                                            <div class="p-1">
                                                <div class="progress animated-progress progress-sm">
                                                    <div class="progress-bar bg-success" role="progressbar"
                                                         style="width: 29.32%" aria-valuenow="29.32"
                                                         aria-valuemin="0" aria-valuemax="100"></div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-auto">
                                            <div class="p-1">
                                                <h6 class="mb-0 text-muted">1063</h6>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- end row -->

                                    <div class="row align-items-center g-2">
                                        <div class="col-auto">
                                            <div class="p-1">
                                                <h6 class="mb-0">3 star</h6>
                                            </div>
                                        </div>
                                        <div class="col">
                                            <div class="p-1">
                                                <div class="progress animated-progress progress-sm">
                                                    <div class="progress-bar bg-warning" role="progressbar"
                                                         style="width: 18.12%" aria-valuenow="18.12"
                                                         aria-valuemin="0" aria-valuemax="100"></div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-auto">
                                            <div class="p-1">
                                                <h6 class="mb-0 text-muted">997</h6>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- end row -->

                                    <div class="row align-items-center g-2">
                                        <div class="col-auto">
                                            <div class="p-1">
                                                <h6 class="mb-0">2 star</h6>
                                            </div>
                                        </div>
                                        <div class="col">
                                            <div class="p-1">
                                                <div class="progress animated-progress progress-sm">
                                                    <div class="progress-bar bg-success" role="progressbar"
                                                         style="width: 4.98%" aria-valuenow="4.98"
                                                         aria-valuemin="0" aria-valuemax="100"></div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-auto">
                                            <div class="p-1">
                                                <h6 class="mb-0 text-muted">227</h6>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- end row -->

                                    <div class="row align-items-center g-2">
                                        <div class="col-auto">
                                            <div class="p-1">
                                                <h6 class="mb-0">1 star</h6>
                                            </div>
                                        </div>
                                        <div class="col">
                                            <div class="p-1">
                                                <div class="progress animated-progress progress-sm">
                                                    <div class="progress-bar bg-danger" role="progressbar"
                                                         style="width: 7.42%" aria-valuenow="7.42"
                                                         aria-valuemin="0" aria-valuemax="100"></div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-auto">
                                            <div class="p-1">
                                                <h6 class="mb-0 text-muted">408</h6>
                                            </div>
                                        </div>
                                    </div><!-- end row -->
                                </div>
                            </div>

                            <div class="card sidebar-alert bg-light border-0 text-center mx-4 mb-0 mt-3">
                                <div class="card-body">
                                    <img src="Content/assets/images/giftbox.png" alt="">
                                    <div class="mt-4">
                                        <h5>Invite New Seller</h5>
                                        <p class="text-muted lh-base">
                                            Refer a new seller to us and earn $100
                                            per refer.
                                        </p>
                                        <button type="button"
                                                class="btn btn-primary btn-label rounded-pill">
                                            <i class="ri-mail-fill label-icon align-middle rounded-pill fs-16 me-2"></i>
                                            Invite Now
                                        </button>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div> <!-- end card-->
                </div> <!-- end .rightbar-->

            </div> <!-- end col -->
        </div>

    </div>
    <!-- container-fluid -->
</div>
@section Scripts{
    <script type="text/javascript" src="https://cdn.jsdelivr.net/jquery/latest/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js" integrity="sha512-ElRFoEQdI5Ht6kZvyzXhYG9NqjtkmlkfYk0wr6wHxU9JEHakS7UJZNeml5ALk+8IKlU6jDgMabC3vkumRokgJA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery-year-select@1.2.0/lib/year-select.js"></script>

    <script>
        $(document).ready(function () {

            /*alert('loaded')*/

            var dt = '@dt.ToString("yyyy-MM-dd")';

            var regionId = "";

            var areaId = "";




            /*Dashboard Header start*/

            function dashboardHeader(pDate) {
                $.ajax({
                    url: "/Dashboard/DashboardHeaderJson",
                    data: { dt: pDate },
                    beforeSend: function () {
                        showCardSpinner('.card:has(#dashboard-header) .card-body');
                    },
                    success: function (result) {
                        $("#dashboard-header").html(result);
                    },
                    error: function () {
                        $("#dashboard-header").html('<div class="text-danger text-center py-4">Failed to load data.</div>');
                    },
                    complete: function () {
                        hideCardSpinner();
                    }
                });
            }


            dashboardHeader(dt);

            $('#dashboard-header-date').change(function () {


                dt = $(this).val();

                dashboardHeader(dt);

                alert(dt)

            })

            /*Dashboard Header ends*/

            /*nation wise sku kpi start*/

            function nationWiseSkuKpi(pDate, regionId, areaId) {
                $.ajax({
                    url: "/Dashboard/NationWiseSkuKpiJson",
                    data: { dt: pDate, region_id : regionId, area_id : areaId },
                    beforeSend: function () {
                        showCardSpinner('.card:has(#nation-wise-sku-kpi) .card-body');
                    },
                    success: function (result) {
                        $("#nation-wise-sku-kpi").html(result);
                    },
                    error: function () {
                        $("#nation-wise-sku-kpi").html('<div class="text-danger text-center py-4">Failed to load data.</div>');
                    },
                    complete: function () {
                        hideCardSpinner();
                    }
                });
            }


            nationWiseSkuKpi(dt, regionId, areaId);

            $('#nation-wise-sku-kpi-date').change(function () {


                dt = $(this).val();

                regionId = $('#national-sku-kpi-region').val()

                areaId = $('#national-sku-kpi-area').val()

                nationWiseSkuKpi(dt, regionId, areaId);

                alert(dt)

            })

            // Populate area dropdown on region change
            $('#national-sku-kpi-region').change(function () {
                var regionId = $(this).val();

                var areaId = '';

                alert(areaId)

                if (regionId && regionId !== "") {
                    $.ajax({
                        url: '/Dashboard/GetAreaByRegion', // Controller Action
                        type: 'GET',
                        data: { region_id: regionId },
                        success: function (data) {
                            var areaDropdown = $('#national-sku-kpi-area');
                            areaDropdown.empty();
                            areaDropdown.append('<option value="">Select Area</option>');

                            nationWiseSkuKpi(dt, regionId, areaId);

                            if (data && data.length > 0) {
                                $.each(data, function (i, item) {
                                    console.log(item)
                                    areaDropdown.append(`<option value="${item.AREA_ID}">${item.AREA_NAME}</option>`);
                                });
                            } else {
                                areaDropdown.append('<option disabled>No areas found</option>');
                            }
                        },
                        error: function () {
                            alert('Failed to load areas.');
                        }
                    });
                } else {
                    $('#national-sku-kpi-area').html('<option>Select Area</option>');
                }
            });


            // Populate area dropdown on region change
            $('#national-sku-kpi-area').change(function () {
                var regionId = $('#national-sku-kpi-region').val();

                var areaId = $(this).val();

                alert(areaId)

                nationWiseSkuKpi(dt, regionId, areaId);
            });

            $("body").on("click", ".focus-category", function () {

                var focusCategoryId = $(this).attr("id");

                regionId = $('#national-sku-kpi-region').val()

                areaId = $('#national-sku-kpi-area').val()

                // Construct the full URL with parameters
                const url = `/dashboard/ProductSalesComparison?p_date_to=${encodeURIComponent(dt)}&region_id=${encodeURIComponent(regionId)}&area_id=${encodeURIComponent(areaId)}&category_id=&focus_category_id=${encodeURIComponent(focusCategoryId)}`;

                // Open the constructed URL in a new tab
                window.open(url, '_blank');
            });


            /*nation wise sku kpi ends*/

            /*own db wise sku kpi start*/



            var ownDbDt = '@dt.ToString("yyyy-MM-dd")';

            var ownDbRegionId = "";

            var ownDbAreaId = "";

            function owndbWiseSkuKpi(pDate, region, area) {
                $.ajax({
                    url: "/Dashboard/OwnDbWiseSkuKpiJson",
                    data: { dt: pDate, region_id: regionId, area_id: areaId },
                    beforeSend: function () {
                        showCardSpinner('.card:has(#owndb-wise-sku-kpi) .card-body');
                    },
                    success: function (result) {
                        $("#owndb-wise-sku-kpi").html(result);
                    },
                    error: function () {
                        $("#owndb-wise-sku-kpi").html('<div class="text-danger text-center py-4">Failed to load data.</div>');
                    },
                    complete: function () {
                        hideCardSpinner();
                    }
                });
            }

            owndbWiseSkuKpi(ownDbDt, ownDbRegionId, ownDbAreaId);

            $('#owndb-wise-sku-kpi-date').change(function () {

                ownDbDt = $(this).val();

                owndbWiseSkuKpi(ownDbDt, ownDbRegionId, ownDbAreaId);

            })

            /*owndb wise sku kpi ends*/


            /*mtd primary vs secondary sales start*/
            var nationWisePriVsSecChannel, nationWisePriVsSecAreaId = ""

            function nationWisemtdPrimaryVsSecondary(pDate, channel, areaId) {
                $.ajax({
                    url: "/Dashboard/NationWisePrimaryVsSecondaryJson",
                    data: { dt: pDate, channel: channel, area_id: areaId },
                    beforeSend: function () {
                        showCardSpinner('.card:has(#nation-wise-mtd-pri-vs-sec-sales) .card-body');
                    },
                    success: function (result) {
                        $("#nation-wise-mtd-pri-vs-sec-sales").html(result);
                    },
                    error: function () {
                        $("#nation-wise-mtd-pri-vs-sec-sales").html('<div class="text-danger text-center py-4">Failed to load data.</div>');
                    },
                    complete: function () {
                        hideCardSpinner();
                    }
                });
            }


            nationWisemtdPrimaryVsSecondary(dt, nationWisePriVsSecChannel, nationWisePriVsSecAreaId);

            $('#nation-wise-sec-vs-primary-dt').change(function () {


                dt = $(this).val();

                nationWisePriVsSecChannel = $('#nation-wise-mtd-pri-vs-sec-channel').val()

                nationWisePriVsSec = $('#nation-wise-mtd-pri-vs-sec-area').val()

                nationWisemtdPrimaryVsSecondary(dt, nationWisePriVsSecChannel, nationWisePriVsSec);

                alert(dt)

            })

            // Populate area dropdown on region change
            $('#nation-wise-mtd-pri-vs-sec-channel').change(function () {
                var channel = $(this).val();

                var areaId = "";

                nationWisemtdPrimaryVsSecondary(dt, channel, areaId);

            });



            /*mtd primary vs secondary sales ends*/


            /* MoM Sales bar chart */

            $("#mom-business-progress-date").change(function () {
                mom_business_progress_data();

            });

            $("#mom-business-channel").change(function () {
                mom_business_progress_data();

            });

            var rawData = [];


            mom_business_progress_data();

            function mom_business_progress_data() {

                var mom_date = $("#mom-business-progress-date").val();
                var mom_channel = $("#mom-business-channel").val();
                var mom_no_months = $("#mom-no-months").val();

            var baseUrl = '@Url.Content("~/")';
            $.ajax({
                url: baseUrl + 'dashboard/getMoMBusinessProgress',
                type: 'GET',
                beforeSend: function () {
                    showCardSpinner('.card:has(#mom-business-progress-date) .card-body');
                },
                data: { p_date_to: mom_date, mom_channel: mom_channel, p_no_months: mom_no_months },
                success: function (result) {

                    if (result != null) {
                        rawData = JSON.parse(result);
                        console.log(rawData);
                        mom_business_progress();
                    }
                },
                error: function (xhr, status, error) {
                    console.error("Error fetching data:", error);
                    alert("Failed to fetch business progress data.");
                },
                complete: function () {
                    hideCardSpinner();
                }
            });


            }



            function getChartColorsArray(e) {
                if (null !== document.getElementById(e)) {
                    var t = document.getElementById(e).getAttribute("data-colors");
                    if (t) return (t = JSON.parse(t)).map(function (e) {
                        var t = e.replace(" ", "");
                        return -1 === t.indexOf(",") ? getComputedStyle(document.documentElement).getPropertyValue(t) || t : 2 == (e = e.split(",")).length ? "rgba(" + getComputedStyle(document.documentElement).getPropertyValue(e[0]) + "," + e[1] + ")" : t
                    });
                    console.warn("data-colors atributes not found on", e)
                }
            }



            var momChart = null;

            function mom_business_progress() {
                var mom_chart_color = getChartColorsArray("mom_business_progress");

                const categories = rawData.map(item => {
                    const d = new Date(item.SALES_MONTH);
                    const month = d.toLocaleString('default', { month: 'short' });
                    const year = d.getFullYear().toString().substr(2);
                    return `${month} ${year}`;
                });

                const salesData = rawData.map(item => item.SALES_IN_TP);

                const options = {
                    chart: {
                        type: 'bar',
                        height: 400
                    },
                    title: {
                        text: 'Month-wise Sales in TP',
                        align: 'center'
                    },
                    series: [{
                        name: 'Sales (TP)',
                        data: salesData
                    }],
                    xaxis: {
                        categories: categories,
                        title: {
                            text: 'Month'
                        }
                    },
                    yaxis: {
                        title: {
                            text: 'Sales (TP in Crore)'
                        }
                    },
                    dataLabels: {
                        enabled: true
                    },
                    colors: mom_chart_color,
                    grid: {
                        show: true,
                        xaxis: {
                            lines: {
                                show: true
                            }
                        },
                        yaxis: {
                            lines: {
                                show: false
                            }
                        },
                        padding: {
                            top: 0,
                            right: -2,
                            bottom: 15,
                            left: 10
                        }
                    },
                    legend: {
                        show: true,
                        horizontalAlign: "center",
                        offsetX: 0,
                        offsetY: -5,
                        markers: {
                            width: 9,
                            height: 9,
                            radius: 6
                        },
                        itemMargin: {
                            horizontal: 10,
                            vertical: 0
                        }
                    },
                    plotOptions: {
                        bar: {
                            columnWidth: "30%",
                            barHeight: "70%"
                        }
                    }
                };

                // Destroy existing chart before rendering new one
                if (momChart !== null) {
                    momChart.destroy();
                }

                momChart = new ApexCharts(document.querySelector("#mom_business_progress"), options);
                momChart.render();
            }

            /* MoM Sales bar chart END */



            /** MoM Focus Category Business Progress **/



            $("#mom-focus-cat-business-progress-date").change(function () {

                mom_focus_cat_business_progress_data();
            });

            $("#mom-focus-cat-business-channel").change(function () {

                mom_focus_cat_business_progress_data();
            });


            mom_focus_cat_business_progress_data();

            function mom_focus_cat_business_progress_data() {

                var mom_date = $("#mom-focus-cat-business-progress-date").val();
                var mom_channel = $("#mom-focus-cat-business-channel").val();
                var mom_no_months = "";

            var baseUrl = '@Url.Content("~/")';
            $.ajax({
                url: baseUrl + 'dashboard/getMoMFocusCatBusinessProgress',
                type: 'GET',
                beforeSend: function () {
                    showCardSpinner('.card:has(#mom-focus-cat-business-progress-date) .card-body');
                },
                data: { p_date_to: mom_date, mom_channel: mom_channel, p_no_months: mom_no_months },
                success: function (result) {

                    if (result != null) {
                        focusCatBusinessTPData = JSON.parse(result);
                        //console.log("Focus Category Business Progress")
                        //console.log(focusCatBusinessTPData);
                        mom_focus_cat_business_progress(focusCatBusinessTPData);
                    }
                },
                error: function (xhr, status, error) {
                    console.error("Error fetching data:", error);
                    alert("Failed to fetch business progress data.");
                },
                complete: function () {
                    hideCardSpinner();
                }
            });


        }


            var momCatChart = null;

            function mom_focus_cat_business_progress(focusCatBusinessTPData) {
                var mom_chart_color = getChartColorsArray("mom_focus_cat_business_progress");

                // Assume this is your JSON response

                // Step 1: Get all unique months
                const uniqueMonths = [...new Set(focusCatBusinessTPData.map(item => item.SALES_MONTH))]
                    .sort()
                    .map(dateStr => {
                        const d = new Date(dateStr);
                        const month = d.toLocaleString('default', { month: 'short' });
                        const year = d.getFullYear().toString().substr(2);
                        return `${month} '${year}`;
                    });

                // Step 2: Group by category
                const categories = [...new Set(focusCatBusinessTPData.map(item => item.FOCUS_CATEGORY_NAME))];

                const grouped = {};
                categories.forEach(cat => {
                    grouped[cat] = new Array(uniqueMonths.length).fill(0);
                });

                focusCatBusinessTPData.forEach(item => {
                    const date = new Date(item.SALES_MONTH);
                    const monthLabel = `${date.toLocaleString('default', { month: 'short' })} '${date.getFullYear().toString().substr(2)}`;
                    const index = uniqueMonths.indexOf(monthLabel);
                    grouped[item.FOCUS_CATEGORY_NAME][index] = item.SALES_IN_TP;
                });

                // Step 3: Build Apex series
                const series = categories.map(cat => ({
                    name: cat,
                    data: grouped[cat]
                }));

                // Step 4: Create the Apex Line Chart
                const options = {
                    chart: {
                        type: 'line',
                        height: 400,
                        toolbar: {
                            show: true
                        }
                    },
                    series: series,
                    xaxis: {
                        categories: uniqueMonths,
                        title: {
                            text: "Month"
                        }
                    },
                    yaxis: {
                        title: {
                            text: "Sales (in TP)"
                        }
                    },
                    title: {
                        text: 'Category-wise Sales Trend',
                        align: 'center'
                    },
                    dataLabels: {
                        enabled: false
                    },
                    stroke: {
                      //  curve: 'smooth',
                        width: 2
                    },
                    legend: {
                        position: 'bottom'
                    },
                    tooltip: {
                        shared: true,
                        intersect: false
                    }
                };

                momCatChart = new ApexCharts(document.querySelector("#mom_focus_cat_business_progress"), options);
                momCatChart.render();

            }


            /** MoM Focus Category Business Progress END **/



            /** MoM Eco Memo Business Progress **/

            mom_eco_memo_business_progress_data();

            function mom_eco_memo_business_progress_data() {

                var mom_date = $("#mom-eco-memo-business-progress-date").val();
                var mom_channel = $("#mom-eco-memo-business-channel").val();
                var mom_no_months = "";

            var baseUrl = '@Url.Content("~/")';
            $.ajax({
                url: baseUrl + 'dashboard/getMoMEcoMemoBusinessProgress',
                type: 'GET',
                beforeSend: function () {
                    showCardSpinner('.card:has(#mom-focus-cat-business-progress-date) .card-body');
                },
                data: { p_date_to: mom_date, mom_channel: mom_channel, p_no_months: mom_no_months },
                success: function (result) {

                    if (result != null) {
                      var  momEcoMemoData = JSON.parse(result);
                        console.log("Eco Memo Business Progress")
                        console.log(momEcoMemoData);
                        //mom_business_progress();
                        mom_eco_memo_business_progress(momEcoMemoData);
                    }
                },
                error: function (xhr, status, error) {
                    console.error("Error fetching data:", error);
                    alert("Failed to fetch business progress data.");
                },
                complete: function () {
                    hideCardSpinner();
                }
            });


            }




            var momFocusCatChart = null;


            function mom_eco_memo_business_progress(rawStats) {
                var mom_chart_color = getChartColorsArray("mom_business_progress");

                const months = rawStats.map(item => {
                    const d = new Date(item.SALES_MONTH);
                    return `${d.toLocaleString('default', { month: 'short' })} '${d.getFullYear().toString().substr(2)}`;
                });

                // Series data
                const ecoData = rawStats.map(item => item.ECO);
                const memoData = rawStats.map(item => item.MEMO);
                const salesTPData = rawStats.map(item => item.SALES_TP_IN_CR);
                const salesPerMemoData = rawStats.map(item => item.SALES_PER_MEMO);

                // Chart config
                const options = {
                    chart: {
                        type: 'line',
                        height: 400,
                        toolbar: {
                            show: true
                        }
                    },
                    title: {
                        text: "Monthly Performance Metrics",
                        align: 'center'
                    },
                    xaxis: {
                        categories: months,
                        title: { text: "Month" }
                    },
                    yaxis: {
                        title: { text: "Values" },
                        labels: {
                            formatter: function (val) {
                                return val.toFixed(0);
                            }
                        }
                    },
                    dataLabels: {
                        enabled: false
                    },
                    stroke: {
                        curve: 'smooth',
                        width: 2
                    },
                    tooltip: {
                        shared: true,
                        intersect: false
                    },
                    legend: {
                        position: 'bottom'
                    },
                    series: [
                        { name: "ECO", data: ecoData },
                        { name: "MEMO", data: memoData },
                        { name: "Sales TP (Cr)", data: salesTPData },
                        { name: "Sales/ Memo", data: salesPerMemoData }
                    ]
                };


                // Destroy existing chart before rendering new one
                if (momFocusCatChart !== null) {
                    momFocusCatChart.destroy();
                }

                momFocusCatChart = new ApexCharts(document.querySelector("#mom_eco_memo_business_progress"), options);
                momFocusCatChart.render();
            }



            /** MoM Eco Memo Business Progress End **/



            /* CD MoM Sales bar chart */

            $("#cd-mom-business-progress-date").change(function () {
                mom_business_progress_data();

            });

            $("#cd-mom-business-channel").change(function () {
                mom_business_progress_data();

            });

            var rawData = [];


            cd_mom_business_progress_data();

            function cd_mom_business_progress_data() {

                var mom_date = $("#mom-business-progress-date").val();
                var mom_channel = $("#mom-business-channel").val();
                var mom_no_months = $("#mom-no-months").val();

            var baseUrl = '@Url.Content("~/")';
            $.ajax({
                url: baseUrl + 'dashboard/getMoMBusinessProgress',
                type: 'GET',
                beforeSend: function () {
                    showCardSpinner('.card:has(#mom-business-progress-date) .card-body');
                },
                data: { p_date_to: mom_date, mom_channel: mom_channel, p_no_months: mom_no_months, p_cd:'1015' },
                success: function (result) {

                    if (result != null) {
                        rawData = JSON.parse(result);
                        console.log(rawData);
                        cd_mom_business_progress();
                    }
                },
                error: function (xhr, status, error) {
                    console.error("Error fetching data:", error);
                    alert("Failed to fetch business progress data.");
                },
                complete: function () {
                    hideCardSpinner();
                }
            });


            }



            function getChartColorsArray(e) {
                if (null !== document.getElementById(e)) {
                    var t = document.getElementById(e).getAttribute("data-colors");
                    if (t) return (t = JSON.parse(t)).map(function (e) {
                        var t = e.replace(" ", "");
                        return -1 === t.indexOf(",") ? getComputedStyle(document.documentElement).getPropertyValue(t) || t : 2 == (e = e.split(",")).length ? "rgba(" + getComputedStyle(document.documentElement).getPropertyValue(e[0]) + "," + e[1] + ")" : t
                    });
                    console.warn("data-colors atributes not found on", e)
                }
            }



            var cdMomChart = null;

            function cd_mom_business_progress() {
                var cd_mom_chart_color = getChartColorsArray("cd_mom_business_progress");

                const categories = rawData.map(item => {
                    const d = new Date(item.SALES_MONTH);
                    const month = d.toLocaleString('default', { month: 'short' });
                    const year = d.getFullYear().toString().substr(2);
                    return `${month} ${year}`;
                });

                const salesData = rawData.map(item => item.SALES_IN_TP);

                const options = {
                    chart: {
                        type: 'bar',
                        height: 400
                    },
                    title: {
                        text: 'Commission Dealer (CD) Month-wise Sales in TP',
                        align: 'center'
                    },
                    series: [{
                        name: 'Sales (TP)',
                        data: salesData
                    }],
                    xaxis: {
                        categories: categories,
                        title: {
                            text: 'Month'
                        }
                    },
                    yaxis: {
                        title: {
                            text: 'Sales (TP in Crore)'
                        }
                    },
                    dataLabels: {
                        enabled: true
                    },
                    colors: cd_mom_chart_color,
                    grid: {
                        show: true,
                        xaxis: {
                            lines: {
                                show: true
                            }
                        },
                        yaxis: {
                            lines: {
                                show: false
                            }
                        },
                        padding: {
                            top: 0,
                            right: -2,
                            bottom: 15,
                            left: 10
                        }
                    },
                    legend: {
                        show: true,
                        horizontalAlign: "center",
                        offsetX: 0,
                        offsetY: -5,
                        markers: {
                            width: 9,
                            height: 9,
                            radius: 6
                        },
                        itemMargin: {
                            horizontal: 10,
                            vertical: 0
                        }
                    },
                    plotOptions: {
                        bar: {
                            columnWidth: "30%",
                            barHeight: "70%"
                        }
                    }
                };

                // Destroy existing chart before rendering new one
                if (cdMomChart !== null) {
                   cdMomChart.destroy();
                }

                cdMomChart = new ApexCharts(document.querySelector("#cd_mom_business_progress"), options);
                cdMomChart.render();
            }

            /* CD MoM Sales bar chart END */



                /** MoM Eco Memo Business Progress **/

            mom_region_eco_memo_business_progress_data();

            function mom_region_eco_memo_business_progress_data() {

                var mom_date = $("#mom-region-echo-memo-business-progress-date").val();
                var mom_channel = $("#mom-region-echo-memo-focus-cat-business-channel").val();
                var mom_no_months = "";

            var baseUrl = '@Url.Content("~/")';
            $.ajax({
                url: baseUrl + 'dashboard/getMoMRegionEcoMemoBusinessProgress',
                type: 'GET',
                beforeSend: function () {
                    showCardSpinner('.card:has(#mom-region-echo-memo-business-progress-date) .card-body');
                },
                data: { p_date_to: mom_date, mom_channel: mom_channel, p_no_months: mom_no_months },
                success: function (result) {

                    if (result != null) {
                      var  momRegionEcoMemoData = JSON.parse(result);
                        console.log("Eco Region Memo Business Progress")
                        console.log(momRegionEcoMemoData);
                        //mom_business_progress();
                        mom_region_eco_memo_business_progress(momRegionEcoMemoData);
                    }
                },
                error: function (xhr, status, error) {
                    console.error("Error fetching data:", error);
                    alert("Failed to fetch business progress data.");
                },
                complete: function () {
                    hideCardSpinner();
                }
            });


            }




            var momRegionEcoMemoChart = null;


            function mom_region_eco_memo_business_progress(rawData) {
                var mom_chart_color = getChartColorsArray("mom_business_progress");




                // Get unique sorted months
                const months = [...new Set(rawData.map(item => {
                    const d = new Date(item.SALES_MONTH);
                    return `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}`;
                }))].sort();

                // Get unique regions
                const regions = [...new Set(rawData.map(item => item.REGION_NAME))];

                // Choose the metric to plot (e.g., "ECO", "MEMO", "SALES_TP_IN_CR", etc.)
                const metric = "ECO";

                // Build series per region
                const series = regions.map(region => {
                    const dataForRegion = rawData.filter(item => item.REGION_NAME === region);
                    const data = months.map(month => {
                        const match = dataForRegion.find(item => {
                            const d = new Date(item.SALES_MONTH);
                            const itemMonth = `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}`;
                            return itemMonth === month;
                        });
                        return match ? match[metric] : 0;
                    });

                    return {
                        name: region,
                        data: data
                    };
                });

                console.log({ categories: months, series });





                // Chart config
                const options = {
                    chart: {
                        type: 'line',
                        height: 400,
                        toolbar: {
                            show: true
                        }
                    },
                    title: {
                        text: "Monthly Performance Metrics",
                        align: 'center'
                    },
                    xaxis: {
                        categories: months,
                        title: { text: "Month" }
                    },
                    yaxis: {
                        title: { text: "Region wise " + metric  },
                        labels: {
                            formatter: function (val) {
                                return val.toFixed(0);
                            }
                        }
                    },
                    dataLabels: {
                        enabled: false
                    },
                    stroke: {
                        curve: 'smooth',
                        width: 2
                    },
                    tooltip: {
                        shared: true,
                        intersect: false
                    },
                    legend: {
                        position: 'bottom'
                    },
                    series: series
                };


                // Destroy existing chart before rendering new one
                if (momRegionEcoMemoChart !== null) {
                    momRegionEcoMemoChart.destroy();
                }

                momRegionEcoMemoChart = new ApexCharts(document.querySelector("#mom_region_eco_memo_business_progress"), options);
                momRegionEcoMemoChart.render();
            }



            /** MoM Eco Memo Business Progress End **/

            /** MoM Eco Memo Business Progress **/

            quarterly_business_trend_data();

            function quarterly_business_trend_data() {

                var mom_date = $("#quarterly-business-trend-progress-date").val();
                var mom_channel = $("#mom-region-echo-memo-focus-cat-business-channel").val();
                var mom_no_months = "";

            var baseUrl = '@Url.Content("~/")';
            $.ajax({
                url: baseUrl + 'dashboard/getQuarterlyBusinessTrend',
                type: 'GET',
                beforeSend: function () {
                    showCardSpinner('.card:has(#quarterly-business-trend-progress-date) .card-body');
                },
                data: { p_date_to: mom_date, mom_channel: mom_channel, p_no_months: mom_no_months },
                success: function (result) {

                    if (result != null) {
                      var  qbtData = JSON.parse(result);
                        console.log("Quarterly Business Trend")
                        console.log(qbtData);
                        //mom_business_progress();
                        quarterly_business_trend(qbtData);
                    }
                },
                error: function (xhr, status, error) {
                    console.error("Error fetching data:", error);
                    alert("Failed to fetch business progress data.");
                },
                complete: function () {
                    hideCardSpinner();
                }
            });


            }




            var qbtChart = null;


            function quarterly_business_trend(rawData) {
                var mom_chart_color = getChartColorsArray("mom_business_progress");

                const categories = rawData.map(item => item.QUARTER);
                const memoData = rawData.map(item => item.MEMO);
                const ecoData = rawData.map(item => item.ECO);
                const salesData = rawData.map(item => item.SALES_IN_TP);

                    const options = {
                        chart: {
                            type: 'bar',
                            height: 400
                        },
                        title: {
                            text: 'Month-wise Sales in TP',
                            align: 'center'
                        },
                        series: [{
                            name: 'Sales (TP)',
                            data: salesData
                        },
                            {
                                name: 'MEMO',
                                data: memoData
                            }, {
                                name: 'ECO',
                                data: ecoData
                            }],
                        xaxis: {
                            categories: categories,
                            title: {
                                text: 'Quarter'
                            }
                        },
                        yaxis: {
                            title: {
                                text: 'Sales (TP in Crore) | Memo | ECO'
                            }
                        },
                        dataLabels: {
                            enabled: true
                        },
                       // colors: mom_chart_color,
                        grid: {
                            show: true,
                            xaxis: {
                                lines: {
                                    show: true
                                }
                            },
                            yaxis: {
                                lines: {
                                    show: false
                                }
                            },
                            padding: {
                                top: 0,
                                right: -2,
                                bottom: 15,
                                left: 10
                            }
                        },
                        legend: {
                            show: true,
                            horizontalAlign: "center",
                            offsetX: 0,
                            offsetY: -5,
                            markers: {
                                width: 9,
                                height: 9,
                                radius: 6
                            },
                            itemMargin: {
                                horizontal: 10,
                                vertical: 0
                            }
                        },
                        //plotOptions: {
                        //    bar: {
                        //        columnWidth: "30%",
                        //        barHeight: "70%"
                        //    }
                        //}
                    };




                // Destroy existing chart before rendering new one
                if (qbtChart !== null) {
                    qbtChart.destroy();
                }

                qbtChart = new ApexCharts(document.querySelector("#quarterly_business_trend"), options);
                qbtChart.render();
            }

            /** MoM Eco Memo Business Progress End **/





        /************************************************************/


        /* field Stracture wise sales */

            // Helper to sanitize keys for CSS use
            function sanitizeClassName(str) {
                return str.replace(/\s+/g, '_').replace(/[^\w\-]/g, '');
            }



            getFieldStructureSalesInTP_data();

            function getFieldStructureSalesInTP_data() {

                var mom_date = $("#quarterly-business-trend-progress-date").val();
                var mom_channel = $("#mom-region-echo-memo-focus-cat-business-channel").val();
                var mom_no_months = "";
                var dealer_id = "18";
                var limit = "0";
                //getSalesStatusRouteWise(string p_date_to, string mom_channel, string p_no_months, string dealer_id, string limit)
            var baseUrl = '@Url.Content("~/")';
            $.ajax({
                url: baseUrl + 'dashboard/getFieldStructureSalesInTP',
                type: 'GET',
                beforeSend: function () {
                    showCardSpinner('.card:has(#field_strudcture_wise_sales) .card-body');
                },
                //data: { p_date_to: mom_date, mom_channel: mom_channel, p_no_months: mom_no_months, dealer_id:dealer_id, limit:limit },
                success: function (result) {
                    console.log("fieldStructureSalesInTPData");
                    console.log(result);
                    if (result != null) {
                        var  fieldStructureSalesInTPData = JSON.parse(result);
                        console.log(fieldStructureSalesInTPData);

                        renderTableFieldStructureSalesInTP(fieldStructureSalesInTPData);


                    }
                },
                error: function (xhr, status, error) {
                    console.error("Error fetching data:", error);
                    alert("Failed to fetch business progress data.");
                },
                complete: function () {
                    hideCardSpinner();
                }
            });


            }

            const field_strudcture_wise_sales_table_tbody = document.getElementById("field_strudcture_wise_sales_table_body");
            const routeSalesStatusTable = document.getElementById("routeSalesStatusTable");

            function sanitizeClassName(name) {
                return name.replace(/\s+/g, "_").replace(/[^\w-]/g, "");
            }

            function fssToggleGroup(groupClass) {
                const rows = document.querySelectorAll(`tr[data-parent^="${groupClass}"]`);
                const icon = document.getElementById(`icon-${groupClass}`);
                const shouldExpand = icon.textContent === "▶";

                // Toggle visibility
                rows.forEach(row => {
                    const direct = row.dataset.parent === groupClass;
                    if (direct) {
                        row.classList.toggle("hidden", !shouldExpand);
                    }

                    // Always collapse deeper children when collapsing
                    if (!shouldExpand) {
                        row.classList.add("hidden");
                        const rowClass = row.dataset.key;
                        const rowIcon = document.getElementById(`icon-${rowClass}`);
                        if (rowIcon) rowIcon.textContent = "▶";
                    }
                });

                icon.textContent = shouldExpand ? "▼" : "▶";
            }

            function renderTableFieldStructureSalesInTP(data) {

                if (field_strudcture_wise_sales_table_tbody)
                    field_strudcture_wise_sales_table_tbody.innerHTML = "";

                const grouped = {};

                // Group the data
                data.forEach(item => {
                    const { REGION_NAME, AREA_NAME, TERITORRY_NAME } = item;

                    if (!grouped[REGION_NAME]) grouped[REGION_NAME] = {};
                    if (!grouped[REGION_NAME][AREA_NAME]) grouped[REGION_NAME][AREA_NAME] = {};
                    if (!grouped[REGION_NAME][AREA_NAME][TERITORRY_NAME]) {
                        grouped[REGION_NAME][AREA_NAME][TERITORRY_NAME] = [];
                    }

                    grouped[REGION_NAME][AREA_NAME][TERITORRY_NAME].push(item);
                });

                // Render rows
                Object.keys(grouped).forEach(region => {
                    const regionKey = sanitizeClassName(region);
                    let regionSum = 0;

                    const regionRow = document.createElement("tr");
                    regionRow.className = `group-header`;
                    regionRow.dataset.key = regionKey;
                    regionRow.onclick = () => fssToggleGroup(regionKey);
                    regionRow.innerHTML = `
        <td colspan="4">
          <span class="toggle-icon" id="icon-${regionKey}">▶</span>${region}
        </td>
        <td><span id="sum-${regionKey}">0</span></td>
      `;
                    field_strudcture_wise_sales_table_tbody.appendChild(regionRow);

                    Object.keys(grouped[region]).forEach(area => {
                        const areaKey = sanitizeClassName(`${region}_${area}`);
                        let areaSum = 0;

                        const areaRow = document.createElement("tr");
                        areaRow.className = `subgroup-header hidden`;
                        areaRow.dataset.parent = regionKey;
                        areaRow.dataset.key = areaKey;
                        areaRow.onclick = () => fssToggleGroup(areaKey);
                        areaRow.innerHTML = `
          <td></td>
          <td colspan="3">
            <span class="toggle-icon" id="icon-${areaKey}">▶</span>${area}
          </td>

          <td><span id="sum-${areaKey}">0</span></td>
        `;
                        field_strudcture_wise_sales_table_tbody.appendChild(areaRow);

                        Object.keys(grouped[region][area]).forEach(territory => {
                            const territoryKey = sanitizeClassName(`${region}_${area}_${territory}`);
                            const items = grouped[region][area][territory];
                            const territorySum = items.reduce((sum, i) => sum + i.SALES_IN_TP, 0);
                            areaSum += territorySum;

                            const territoryRow = document.createElement("tr");
                            territoryRow.className = `subgroup-header hidden`;
                            territoryRow.dataset.parent = areaKey;
                            territoryRow.dataset.key = territoryKey;
                            territoryRow.onclick = () => fssToggleGroup(territoryKey);
                            territoryRow.innerHTML = `
            <td></td>
            <td></td>
            <td colspan=2>
              <span class="toggle-icon" id="icon-${territoryKey}">▶</span>${territory}
            </td>

            <td>${territorySum.toFixed(2)}</td>
          `;
                            field_strudcture_wise_sales_table_tbody.appendChild(territoryRow);

                            items.forEach(item => {
                                const dealerRow = document.createElement("tr");
                                dealerRow.className = `hidden`;
                                dealerRow.dataset.parent = territoryKey;
                                dealerRow.innerHTML = `
              <td></td>
              <td></td>
              <td></td>
              <td><button class="btn btn-link dealer" id="${item.DEALER_ID}">${item.DEALER_NAME}</button></td>
              <td>${item.SALES_IN_TP.toFixed(2)}</td>
            `;
                                field_strudcture_wise_sales_table_tbody.appendChild(dealerRow);
                            });
                        });

                        document.getElementById(`sum-${areaKey}`).textContent = areaSum.toFixed(2);
                        regionSum += areaSum;
                    });

                    document.getElementById(`sum-${regionKey}`).textContent = regionSum.toFixed(2);
                });
            }

            $("body").on("click", ".dealer", function () {
                var dealerId = $(this).attr('id');
                var dealerName = $(this).html();

                getSalesStatusRouteWise_data(dealerId);
                $("#dealer_info").html ( `Dealer : ${dealerName}`);

            })




        //getSalesStatusRouteWise_data("18");

            function getSalesStatusRouteWise_data(dealer_id, limit="0") {

                var mom_date = $("#quarterly-business-trend-progress-date").val();
                var mom_channel = $("#mom-region-echo-memo-focus-cat-business-channel").val();
                var mom_no_months = "";
               // var dealer_id = "18";
               // var limit = "0";
                //getSalesStatusRouteWise(string p_date_to, string mom_channel, string p_no_months, string dealer_id, string limit)
            var baseUrl = '@Url.Content("~/")';
            $.ajax({
                url: baseUrl + 'dashboard/getSalesStatusRouteWise',
                type: 'GET',
                beforeSend: function () {
                    showCardSpinner('.card:has(#routeSalesStatusTable) .card-body');
                },
                data: { p_date_to: mom_date, mom_channel: mom_channel, p_no_months: mom_no_months, dealer_id:dealer_id, limit:limit },
                success: function (result) {
                    console.log(result);
                    if (result != null) {
                      var  routeSalesData = JSON.parse(result);
                        console.log("getSalesStatusRouteWise")


                        renderGroupedData(routeSalesData);


                    }
                },
                error: function (xhr, status, error) {
                    console.error("Error fetching data:", error);
                    alert("Failed to fetch business progress data.");
                },
                complete: function () {
                    hideCardSpinner();
                }
            });


            }





            //function renderGroupedData3(data) {

            //    $("#routeSalesStatusTable tbody").empty();

            //    let grouped = {};

            //    // Group by ROUTE
            //    data.forEach(row => {
            //        if (!grouped[row.ROUTE]) grouped[row.ROUTE] = [];
            //        grouped[row.ROUTE].push(row);
            //    });

            //    // Inject rows: group -> child1 -> child2 ...
            //    Object.keys(grouped).forEach((groupKey, index) => {
            //        const groupRows = grouped[groupKey];

            //        // Compute totals
            //        const totalTP = groupRows.reduce((sum, r) => sum + parseFloat(r.TOTAL_SALES_IN_TP || 0), 0);
            //        const totalMemo = groupRows.reduce((sum, r) => sum + parseInt(r.TOTAL_MEMO || 0), 0);
            //        const sr_name = groupRows[index]['SO_NAME'];

            //        // Create group row with unique ID
            //        const groupId = `group-${index}`;
            //        const $groupRow = $(`
            //                <tr class="group collapsed" data-group="${groupId}" style="cursor:pointer; background:#dfefff; font-weight:bold;">
            //                    <td colspan="2"><span class="toggle-icon">▶</span> ${groupKey}-[${sr_name}]</td>
            //                    <td>${totalTP.toFixed(2)}</td>
            //                    <td>${totalMemo}</td>
            //                    <td colspan="2"></td>
            //                </tr>
            //            `);

            //        // Insert group row manually into DOM
            //        $("#routeSalesStatusTable tbody").append($groupRow);

            //        // Add child rows but keep them hidden initially
            //        groupRows.forEach(r => {
            //            const $childRow = $(`
            //    <tr class="child-row child-of-${groupId}" style="display:none;">
            //        <td></td>
            //        <td>${r.OUTLET_NAME}</td>
            //        <td>${r.TOTAL_SALES_IN_TP}</td>
            //        <td>${r.TOTAL_MEMO}</td>
            //        <td>${r.NO_OF_SALES_MONTH}</td>
            //        <td>${r.AVG_SALES_PER_MONTH}</td>
            //    </tr>
            //`);
            //            $("#routeSalesStatusTable tbody").append($childRow);
            //        });
            //    });

            //    // Toggle logic
            //    $('.group').off('click').on('click', function () {
            //        const groupId = $(this).data('group');
            //        const isCollapsed = $(this).hasClass('collapsed');
            //        $(this).toggleClass('collapsed');
            //        $(this).find('.toggle-icon').text(isCollapsed ? '▼' : '▶');

            //        $(`.child-of-${groupId}`).toggle(isCollapsed);
            //    });
            //}


            function renderGroupedData(data) {
                // Clear existing rows correctly
                $("#routeSalesStatusTable tbody").empty();

                let grouped = {};

                // Group by ROUTE
                data.forEach(row => {
                    if (!grouped[row.ROUTE]) grouped[row.ROUTE] = [];
                    grouped[row.ROUTE].push(row);
                });

                // Inject rows: group -> child1 -> child2 ...
                Object.keys(grouped).forEach((groupKey, index) => {
                    const groupRows = grouped[groupKey];

                    // Compute totals
                    const totalTP = groupRows.reduce((sum, r) => sum + parseFloat(r.TOTAL_SALES_IN_TP || 0), 0);
                    const totalMemo = groupRows.reduce((sum, r) => sum + parseInt(r.TOTAL_MEMO || 0), 0);
                    const noMonths = groupRows.reduce((max, r) => max > parseInt(r.NO_OF_SALES_MONTH || 0) ? max : parseInt(r.NO_OF_SALES_MONTH || 0) , 0);
                    const sr_name = groupRows[0]['SO_NAME']; // use first row, not index
                    const avgMonthSales = (totalTP / noMonths).toFixed(2);

                    // Create group row with unique ID
                    const groupId = `group-${index}`;
                    const $groupRow = $(`
            <tr class="group collapsed" data-group="${groupId}" style="cursor:pointer; background:#dfefff; font-weight:bold;">
                <td colspan="2"><span class="toggle-icon">▶</span> ${groupKey} [${sr_name}]</td>
                <td>${totalTP.toFixed(2)}</td>
                <td>${totalMemo}</td>
                <td>${noMonths}</td>
                <td>${avgMonthSales}</td>
            </tr>
        `);

                    // Insert group row manually into DOM
                    $("#routeSalesStatusTable tbody").append($groupRow);

                    // Add child rows (hidden by default)
                    groupRows.forEach(r => {
                        const $childRow = $(`
                <tr class="child-row child-of-${groupId}" style="display:none;">
                    <td></td>
                    <td>${r.OUTLET_NAME}</td>
                    <td>${r.TOTAL_SALES_IN_TP}</td>
                    <td>${r.TOTAL_MEMO}</td>
                    <td>${r.NO_OF_SALES_MONTH}</td>
                    <td>${r.AVG_SALES_PER_MONTH}</td>
                </tr>
            `);
                        $("#routeSalesStatusTable tbody").append($childRow);
                    });
                });

                // Toggle logic
                $('.group').off('click').on('click', function () {
                    const groupId = $(this).data('group');
                    const isCollapsed = $(this).hasClass('collapsed');
                    $(this).toggleClass('collapsed');
                    $(this).find('.toggle-icon').text(isCollapsed ? '▼' : '▶');
                    $(`.child-of-${groupId}`).toggle(isCollapsed);
                });
            }

            /* field Stracture wise sales end */

            $("body").on("change", "#RegionSalesTargetAchieve_date", function () {
                getRegionSalesTargetAchieveData();
            })

            getRegionSalesTargetAchieveData();

            function getRegionSalesTargetAchieveData() {

                var mom_date = $("#RegionSalesTargetAchieve_date").val();

            var baseUrl = '@Url.Content("~/")';
            $.ajax({
                url: baseUrl + 'dashboard/getRegionSalesTargetAchieve',
                type: 'GET',
                beforeSend: function () {
                    $("#RegionSalesTargetAchieve").empty();

                    showCardSpinner('.card:has(#RegionSalesTargetAchieve) .card-body');
                },
                data: { p_date_to: mom_date },
                success: function (result) {
                    console.log(result);
                    if (result != null) {
                      var  regionSalesData = JSON.parse(result);
                        console.log("RegionSalesTargetAchieve")


                        var achieveData
                        regionSalesData.forEach(row => {

                            $("#RegionSalesTargetAchieve").append(` <p class="mt-3 mb-1">
                                                    ${row.REGION_NAME} <span class="float-end">${row.ACHIEVE}%</span>
                                                </p>
                                                <div class="progress mt-2" style="height: 6px;">
                                                    <div class="progress-bar progress-bar-striped bg-primary"
                                                         role="progressbar" style="width: ${row.ACHIEVE}%" aria-valuenow="${row.ACHIEVE}"
                                                         aria-valuemin="0" aria-valuemax="47"></div>
                                                </div>`);

                        });


                    }
                },
                error: function (xhr, status, error) {
                    console.error("Error fetching data:", error);
                    alert("Failed to fetch business progress data.");
                },
                complete: function () {
                    hideCardSpinner();
                }
            });

            }






        })

    </script>

}